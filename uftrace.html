<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="keywords" content="uftrace,ftrace,tracing,profiling" />
    <meta name="description" content="A function (graph) tracer for C/C++ userspace programs." />
    <title>uftrace</title>
    <style>
      @import url(https://fonts.googleapis.com/css?family=Droid+Serif);
      @import url(https://fonts.googleapis.com/css?family=Yanone+Kaffeesatz);
      @import url(https://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700,400italic);

      body {
        font-family: 'Droid Serif';
        //font-family: 'Roboto', sans-serif;
	background-color: black;
      }
      textarea {
        //display: none;
      }
      h1, h2, h3, h4 {
        font-family: 'Yanone Kaffeesatz';
        //font-family: 'Roboto', sans-serif;
        //font-family: 'Arials', serif;
        font-weight: 400;
        margin-bottom: 0;
      }
      .remark-slide-content h1 { font-size: 85px; min-height: 87px; }
      .remark-slide-content h2 { font-size: 60px; min-height: 62px; }
      .remark-slide-content h3 { font-size: 35px; min-height: 37px; }
      .remark-slide-content h4 { font-size: 30px; min-height: 32px; }
      .remark-slide-content {
        background-color: #000;
        background-size: cover;
        background-position: center;
        color: #f8f8f8;
        font-size: 24px;
        text-shadow: 0px 0px 16px #000, 0px 0px 32px #000;
        padding: 10px 20px 10px 20px;
      }
      .remark-slide-number { font-size: 20px }
      .footnote {
        font-size: 23px;
        position: absolute;
        bottom: 2em;
        right: 1em;
      }
      .remark-container {
        background-color: #000;
      }
      .remark-slide-scaler {
        -moz-box-shadow: 0 0 30px #000;
        -webkit-box-shadow: 0 0 30px #000;
        box-shadow: 0 0 30px #000;
      }

      li p { line-height: 1.25em; }
      .large { font-size: 2em; }
      a, a > code {
        color: rgb(100, 100, 255);
        text-decoration: none;
      }

      /*
      code {
        background: #e7e8e2;
        border-radius: 5px;
      }
      */

      .remark-code, .remark-inline-code { font-family: 'Ubuntu Mono', monospace; }
      .remark-code-span-highlighted     { background-color: #000; color: red; padding: 0px; }
      .remark-code-line-highlighted     { background-color: #600; }

      .remark-code      { font-size:  22px; }
      .remark-code-line { min-height: 24px; }

      .picture {
        align: center;
        width: 680px;
        background-color: #FFF;
      }
      .center-image {
        background-color: #FFF;
        margin: 0 auto;
        display: block;
      }

      /* Two-column layout */
      .left-column {
        float: left;
        width: 49%;
      }
      .right-column {
        float: right;
        width: 49%;
      }

      /* Code Font Size */
      .code-3px  .remark-code-line { font-size: 3px;  min-height: 5px;  }
      .code-5px  .remark-code-line { font-size: 5px;  min-height: 7px;  }
      .code-7px  .remark-code-line { font-size: 7px;  min-height: 9px;  }
      .code-8px  .remark-code-line { font-size: 8px;  min-height: 10px; }
      .code-9px  .remark-code-line { font-size: 9px;  min-height: 11px; }
      .code-10px .remark-code-line { font-size: 10px; min-height: 12px; }
      .code-11px .remark-code-line { font-size: 11px; min-height: 13px; }
      .code-12px .remark-code-line { font-size: 12px; min-height: 14px; }
      .code-13px .remark-code-line { font-size: 13px; min-height: 15px; }
      .code-14px .remark-code-line { font-size: 14px; min-height: 16px; }
      .code-15px .remark-code-line { font-size: 15px; min-height: 17px; }
      .code-16px .remark-code-line { font-size: 16px; min-height: 18px; }
      .code-17px .remark-code-line { font-size: 17px; min-height: 19px; }
      .code-18px .remark-code-line { font-size: 18px; min-height: 20px; }
      .code-19px .remark-code-line { font-size: 19px; min-height: 21px; }
      .code-20px .remark-code-line { font-size: 20px; min-height: 22px; }
      .code-21px .remark-code-line { font-size: 21px; min-height: 23px; }
      .code-22px .remark-code-line { font-size: 22px; min-height: 24px; }
      .code-23px .remark-code-line { font-size: 23px; min-height: 25px; }
      .code-24px .remark-code-line { font-size: 24px; min-height: 26px; }
      .code-25px .remark-code-line { font-size: 25px; min-height: 27px; }
      .code-26px .remark-code-line { font-size: 26px; min-height: 28px; }

      /* Colors */
      .red      { color: red;     }
      .green    { color: green;   }
      .blue     { color: blue;    }
      .yellow   { color: yellow;  }
      .orange   { color: orange;  }
      .grey     { color: grey;    }
      .cyan     { color: cyan;    }
      .magenta  { color: magenta; }
      x-red     { color: red;     }
      x-green   { color: green;   }
      x-blue    { color: blue;    }
      x-yellow  { color: yellow;  }
      x-orange  { color: orange;  }
      x-grey    { color: grey;    }
      x-cyan    { color: cyan;    }
      x-magenta { color: magenta; }

      /* for TUI pages */
      .tui .remark-code-line {
          font-family: 'Courier New';
          font-size: 14px;
          min-height: 16px;
      }
      x-tui-blue-line  { background-color: blue; }
      x-tui-white-line { background-color: white; color: black; }
    </style>
  </head>
  <body>
    <textarea id="source">

name: title-layout
layout: true
class: center, middle, title

---
name: picture-layout
layout: true
class: center, middle

---
name: basic-layout
layout: true
class: left, top

---
name: title
template: title-layout

# uftrace
### A function (graph) tracer for C/C++ userspace programs
### [https://github.com/namhyung/uftrace](https://github.com/namhyung/uftrace)
.footnote[[https://uftrace.github.io](https://uftrace.github.io)]

---
name: toc
### Table of Contents
- [Installation](#installation)
- [Basic Tracing](#basic-tracing)
  - [(user) Function Tracing](#user-tracing)
  - [Library Function Tracing](#lib-tracing)
  - [Linux Kernel Function Tracing](#kernel-tracing)
  - [Event Tracing](#event-tracing)
- [Filters](#filters)
- [Display Function Arguments](#args)
- [Arguments Detection with Debug Info](#autoargs)
- Recorded Data Analysis
  - [report command](#report)
  - [dump command](#dump)
  - [graph command](#graph)
  - [tui command](#tui)
- Advanced Topics
  - [Dynamic Tracing](#dynamic-tracing)
  - [(Python) Scripting](#python) (TBD)
  - [Triggers](#triggers) (TBD)

---
### uftrace
- The [uftrace](https://github.com/namhyung/uftrace) tool is to trace and analyze execution of a program written in C/C++.
- It was heavily inspired by the [ftrace](https://www.kernel.org/doc/Documentation/trace/ftrace.txt) framework of the Linux kernel (especially function graph tracer) and supports userspace programs.
- It supports various kind of commands and filters to help analysis of the program execution and performance.

---
template: picture-layout
<img src="https://raw.githubusercontent.com/namhyung/uftrace/master/doc/uftrace-live-demo.gif" class="center-image" width="680">

---
### Quick Installation
.footnote[[INSTALL.md](https://github.com/namhyung/uftrace/blob/master/INSTALL.md)]
<pre>
<code class="bash">$ git clone https://github.com/namhyung/uftrace && cd uftrace




$ ./configure
uftrace detected system features:
...         prefix: /usr/local
...         libelf: [ .green[on]  ] - more flexible ELF data handling
...          libdw: [ .red[OFF] ] - DWARF debug info support
...   libpython2.7: [ .red[OFF] ] - python scripting support
...    libncursesw: [ .red[OFF] ] - TUI support
...   cxa_demangle: [ .green[on]  ] - full demangler support with libstdc++
...     perf_event: [ .green[on]  ] - perf (PMU) event support
...       schedule: [ .green[on]  ] - scheduler event support

$ make

$ sudo make install
</code>
</pre>
---
### Quick Installation
.footnote[[INSTALL.md](https://github.com/namhyung/uftrace/blob/master/INSTALL.md)]
<pre>
<code class="bash">$ git clone https://github.com/namhyung/uftrace && cd uftrace

# For Ubuntu Users
$ sudo apt-get install libdw-dev libpython2.7-dev libncursesw5-dev pandoc

$ ./configure
uftrace detected system features:
...         prefix: /usr/local
...         libelf: [ .green[on]  ] - more flexible ELF data handling
...          libdw: [ .green[on]  ] - DWARF debug info support
...   libpython2.7: [ .green[on]  ] - python scripting support
...    libncursesw: [ .green[on]  ] - TUI support
...   cxa_demangle: [ .green[on]  ] - full demangler support with libstdc++
...     perf_event: [ .green[on]  ] - perf (PMU) event support
...       schedule: [ .green[on]  ] - scheduler event support

$ make

$ sudo make install
</code>
</pre>

---
name: basic-tracing
template: title-layout
# Basic Tracing
### record and replay

---
### uftrace
- uftrace is able to trace
  - C/C++ (user space) functions
      - compiled with -pg or -finstrument-functions
  - Library functions
  - Linux kernel functions
  - Some of system events

---
name: user-tracing
### C/C++ (user) Function Tracing
- Compiler assists tracing with -pg or -finstrument-functions

  ```
  $ 
  ```

.left-column[
```
void bar() {

}

void foo() {
  bar();
}

int main() {
  foo();
}
```
]
.right-column[
```
```
]

---
### C/C++ (user) Function Tracing
- Compiler assists tracing with -pg or -finstrument-functions

  ```
  $ gcc foobar.c
  ```

.left-column[
```
void bar() {

}

void foo() {
  bar();
}

int main() {
  foo();
}
```
]
.right-column[
```
<bar>:

  ret

<foo>:

  call <bar>
  ret

<main>:

  call <foo>
  ret
```
]

---
### C/C++ (user) Function Tracing
- Compiler assists tracing with -pg or -finstrument-functions

  ```
  $ gcc `-pg` foobar.c
  ```

.left-column[
```
void bar() {

}

void foo() {
  bar();
}

int main() {
  foo();
}
```
]
.right-column[
```
<bar>:
* call <mcount@plt>
  ret

<foo>:
* call <mcount@plt>
  call <bar>
  ret

<main>:
* call <mcount@plt>
  call <foo>
  ret
```
]

---
class: code-26px
### C/C++ (user) Function Tracing
- uftrace record
  - Run a command and record its trace data

```
  $ gcc foobar.c
```
---
class: code-26px
### C/C++ (user) Function Tracing
- uftrace record
  - Run a command and record its trace data

```
  $ gcc `-pg` foobar.c
```
---
class: code-26px
### C/C++ (user) Function Tracing
- uftrace record
  - Run a command and record its trace data

```
  $ gcc -pg foobar.c
  $ ./a.out
```
---
class: code-26px
### C/C++ (user) Function Tracing
- uftrace record
  - Run a command and record its trace data

```
  $ gcc -pg foobar.c
  $ uftrace `record` a.out
```
---
class: code-26px
### C/C++ (user) Function Tracing
- uftrace replay
  - Print recorded function trace

```
  $ gcc -pg foobar.c
  $ uftrace record a.out
  $ uftrace `replay`
  # DURATION    TID     FUNCTION
              [11558] | main() {
              [11558] |   foo() {
     0.156 us [11558] |     bar();
     0.767 us [11558] |   } /* foo */
     1.140 us [11558] | } /* main */
```
---
class: code-26px
### C/C++ (user) Function Tracing
- uftrace live
  - Trace functions both doing record and replay

```
  $ gcc -pg foobar.c

  $ uftrace `live` a.out
  # DURATION    TID     FUNCTION
              [11558] | main() {
              [11558] |   foo() {
     0.156 us [11558] |     bar();
     0.767 us [11558] |   } /* foo */
     1.140 us [11558] | } /* main */
```
---
class: code-26px
### C/C++ (user) Function Tracing
- uftrace .grey[(live)]
  - .red[live] can be omitted

```
  $ gcc -pg foobar.c

  $ uftrace a.out
  # DURATION    TID     FUNCTION
              [11558] | main() {
              [11558] |   foo() {
     0.156 us [11558] |     bar();
     0.767 us [11558] |   } /* foo */
     1.140 us [11558] | } /* main */
```

---
name: lib-tracing
### Library Function Tracing
- Library Function Tracing works via PLT hooking

```
    $ gcc -pg foobar.c
```

.left-column[
```
void bar() {

}

void foo() {
  bar();
}

int main() {
  foo();
}
```
]
.right-column[
```
<bar>:
  call <mcount@plt>

  ret

<foo>:
  call <mcount@plt>
  call <bar>
  ret

<main>:
  call <mcount@plt>
  call <foo>
  ret
```
]
---
### Library Function Tracing
- Library Function Tracing works via .red[PLT hooking]

```
    $ gcc -pg foobar.c
```

.left-column[
```
void bar() {
  `getpid()`;
}

void foo() {
  bar();
}

int main() {
  foo();
}
```
]
.right-column[
```
<bar>:
  call <mcount@plt>
* call <getpid@plt> # call to PLT
  ret

<foo>:
  call <mcount@plt>
  call <bar>
  ret

<main>:
  call <mcount@plt>
  call <foo>
  ret
```
]
---
class: code-26px
### Library Function Tracing
- Library Function Tracing works via PLT hooking

```
    $ gcc -pg foobar.c
```
---
class: code-26px
### Library Function Tracing
- Library Function Tracing works via PLT hooking

```
    $ gcc -pg foobar.c

    $ uftrace a.out
```
---
class: code-26px
### Library Function Tracing
- Library Function Tracing works via PLT hooking

```
    $ gcc -pg foobar.c

    $ uftrace a.out
    # DURATION    TID     FUNCTION
                [11558] | main() {
                [11558] |   foo() {
                [11558] |     bar() {
       6.263 us [11558] |       `getpid`();
       7.016 us [11558] |     } /* bar */
       7.443 us [11558] |   } /* foo */
       7.826 us [11558] | } /* main */
```
---
class: code-26px
### Library Function Tracing
- --no-libcall
  - Do not record library function invocations.


```
    $ gcc -pg foobar.c

    $ uftrace a.out
    # DURATION    TID     FUNCTION
                [11558] | main() {
                [11558] |   foo() {
                [11558] |     bar() {
       6.263 us [11558] |       getpid();
       7.016 us [11558] |     } /* bar */
       7.443 us [11558] |   } /* foo */
       7.826 us [11558] | } /* main */
```
---
class: code-26px
### Library Function Tracing
- --no-libcall
  - Do not record library function invocations.


```
    $ gcc -pg foobar.c
  
    $ uftrace `--no-libcall` a.out
    # DURATION    TID     FUNCTION
                [11558] | main() {
                [11558] |   foo() {
                [11558] |     bar() {
//       6.263 us [11558] |       getpid();
       7.016 us [11558] |     } /* bar */
       7.443 us [11558] |   } /* foo */
       7.826 us [11558] | } /* main */
```
---
class: code-26px
### Library Function Tracing
- --no-libcall
  - Do not record library function invocations.


```
    $ gcc -pg foobar.c

    $ uftrace `--no-libcall` a.out
    # DURATION    TID     FUNCTION
                [11558] | main() {
                [11558] |   foo() {
       7.016 us [11558] |     bar();
       7.443 us [11558] |   } /* foo */
       7.826 us [11558] | } /* main */
```
---
class: code-26px
### Library Function Tracing
- C++ example
  - new and delete library calls

```
  $ cat new-delete.cpp
  int main()
  {
      int* p = new int;
      delete p;
  }
```
---
class: code-26px
### Library Function Tracing
- C++ example
  - new and delete library calls

```
  $ cat new-delete.cpp
  int main()
  {
      int* p = new int;
      delete p;
  }

  $ g++ -pg new-delete.cpp
```
---
class: code-26px
### Library Function Tracing
- C++ example
  - It shows .red[operator new] and .red[operator delete]

```
  $ uftrace a.out
  # DURATION     TID     FUNCTION
              [180964] | main() {
     2.420 us [180964] |   `operator new`();
     3.170 us [180964] |   `operator delete`();
    11.220 us [180964] | } /* main */
```
---
class: code-26px
### Library Function Tracing
- --nest-libcall
  - Trace function calls between libraries.

```
  $ uftrace `--nest-libcall` a.out
  # DURATION     TID     FUNCTION
              [180978] | main() {
              [180978] |   operator new() {

     4.250 us [180978] |   } /* operator new */
              [180978] |   operator delete() {

     3.547 us [180978] |   } /* operator delete */
    11.857 us [180978] | } /* main */
```
---
class: code-26px
### Library Function Tracing
- --nest-libcall
  - Trace function calls between libraries.

```
  $ uftrace `--nest-libcall` a.out
  # DURATION     TID     FUNCTION
              [180978] | main() {
              [180978] |   operator new() {
     0.957 us [180978] |     `malloc`();
     4.250 us [180978] |   } /* operator new */
              [180978] |   operator delete() {
     1.540 us [180978] |     `free`();
     3.547 us [180978] |   } /* operator delete */
    11.857 us [180978] | } /* main */
```

---
name: kernel-tracing
class: code-26px
### Linux Kernel Function Tracing
- -k, --kernel
  - Trace kernel functions as well as user functions.

```
  $ gcc -pg hello.c
```
---
class: code-26px
### Linux Kernel Function Tracing
- -k, --kernel
  - Trace kernel functions as well as user functions.

```
  $ gcc -pg hello.c
  $ uftrace a.out
  Hello World!
  # DURATION     TID     FUNCTION
              [161960] | main() {
     7.267 us [161960] |   printf();
     6.920 us [161960] |   fflush();
    15.694 us [161960] | } /* main */
```
---
class: code-26px
### Linux Kernel Function Tracing
- -k, --kernel
  - Trace kernel functions as well as user functions.

```
  $ gcc -pg hello.c
  $ `sudo` uftrace `-k` a.out
  Hello World!
  # DURATION     TID     FUNCTION
              [161968] | main() {
              [161968] |   printf() {


    32.457 us [161968] |   } /* printf */
              [161968] |   fflush() {

    25.244 us [161968] |   } /* fflush */
    59.221 us [161968] | } /* main */
```
---
class: code-26px
### Linux Kernel Function Tracing
- -k, --kernel
  - Trace kernel functions as well as user functions.

```
  $ gcc -pg hello.c
  $ `sudo` uftrace `-k` a.out
  Hello World!
  # DURATION     TID     FUNCTION
              [161968] | main() {
              [161968] |   printf() {
     7.770 us [161968] |     `sys_newfstat`();
    11.737 us [161968] |     `__do_page_fault`();
    32.457 us [161968] |   } /* printf */
              [161968] |   fflush() {
    18.637 us [161968] |     `sys_write`();
    25.244 us [161968] |   } /* fflush */
    59.221 us [161968] | } /* main */
```
---
class: code-18px
### Linux Kernel Function Tracing
- -K DEPTH, --kernel-depth=DEPTH
  - Set kernel max function depth separately.

```
  $ sudo uftrace `-K 2` a.out
  Hello World!
```
---
class: code-18px
### Linux Kernel Function Tracing
- -K DEPTH, --kernel-depth=DEPTH
  - Set kernel max function depth separately.

```
  $ sudo uftrace `-K 2` a.out
  Hello World!
  # DURATION     TID     FUNCTION
              [162954] | main() {
              [162954] |   printf() {
              [162954] |     `sys_newfstat`() {
     3.074 us [162954] |       `vfs_fstat`();
     1.200 us [162954] |       `cp_new_stat`();
     6.914 us [162954] |     } /* sys_newfstat */
              [162954] |     `__do_page_fault`() {
     0.643 us [162954] |       `down_read_trylock`();
     0.630 us [162954] |       `_cond_resched`();
     2.440 us [162954] |       `find_vma`();
     9.697 us [162954] |       `handle_mm_fault`();
     0.690 us [162954] |       `up_read`();
    21.813 us [162954] |     } /* __do_page_fault */
    42.064 us [162954] |   } /* printf */
              [162954] |   fflush() {
              [162954] |     `sys_write`() {
     0.933 us [162954] |       `__fdget_pos`();
    18.310 us [162954] |       `vfs_write`();
    27.117 us [162954] |     } /* sys_write */
    30.673 us [162954] |   } /* fflush */
    74.223 us [162954] | } /* main */
```

---
name: event-tracing
class: code-20px
### Event Tracing (scheduling event)
<pre>
<code class="plain">        $ uftrace tests/t-fork
        # DURATION     TID     FUNCTION
                    [ 14528] | main() {
         127.033 us [ 14528] |   fork();
                    [ 14528] |   wait() {
                    [ 14528] |     /* <x-green>linux:sched-out</x-green> */
                    [ 14540] |   } /* fork */
                    [ 14540] |   a() {
                    [ 14540] |     b() {
                    [ 14540] |       c() {
           1.507 us [ 14540] |         getpid();
           2.987 us [ 14540] |       } /* c */
           3.464 us [ 14540] |     } /* b */
           3.854 us [ 14540] |   } /* a */
          13.394 us [ 14540] | } /* main */
                    [ 14528] |     /* <x-green>linux:sched-in</x-green> */
         799.270 us [ 14528] |   } /* wait */
                    [ 14528] |   a() {
                    [ 14528] |     b() {
                    [ 14528] |       c() {
           2.410 us [ 14528] |         getpid();
           3.470 us [ 14528] |       } /* c */
           3.833 us [ 14528] |     } /* b */
           4.144 us [ 14528] |   } /* a */
         952.797 us [ 14528] | } /* main */
</code>
</pre>
---
class: code-20px
### Event Tracing (scheduling event)
<pre>
<code class="plain">        $ uftrace `--no-event` tests/t-fork
        # DURATION     TID     FUNCTION
                    [ 14528] | main() {
         127.033 us [ 14528] |   fork();
                    [ 14528] |   wait() {
                    [ 14540] |   } /* fork */
                    [ 14540] |   a() {
                    [ 14540] |     b() {
                    [ 14540] |       c() {
           1.507 us [ 14540] |         getpid();
           2.987 us [ 14540] |       } /* c */
           3.464 us [ 14540] |     } /* b */
           3.854 us [ 14540] |   } /* a */
          13.394 us [ 14540] | } /* main */
         799.270 us [ 14528] |   } /* wait */
                    [ 14528] |   a() {
                    [ 14528] |     b() {
                    [ 14528] |       c() {
           2.410 us [ 14528] |         getpid();
           3.470 us [ 14528] |       } /* c */
           3.833 us [ 14528] |     } /* b */
           4.144 us [ 14528] |   } /* a */
         952.797 us [ 14528] | } /* main */
</code>
</pre>

---
name: filters
template: title-layout
# Filters
.footnote[[wiki/Tutorial:-Filters](https://github.com/namhyung/uftrace/wiki/Tutorial:-Filters)]

---
class: code-26px
### Filters
- -D DEPTH, --depth=DEPTH
  - Set global trace limit in nesting level.

<pre><code class="plain">  $ gcc -pg foobar.c

  $ uftrace a.out
  # DURATION    TID     FUNCTION
              [11558] | main() {
              [11558] |   foo() {
     0.156 us [11558] |     bar();
     0.767 us [11558] |   } /* foo */
     1.140 us [11558] | } /* main */
</code></pre>
---
class: code-26px
### Filters
- -D DEPTH, --depth=DEPTH
  - Set global trace limit in nesting level.

<pre><code class="plain">  $ gcc -pg foobar.c

  $ uftrace `-D 2` a.out
  # DURATION    TID     FUNCTION
              [11558] | main() {
              [11558] |   foo() {
//     0.156 us [11558] |     bar();
     0.767 us [11558] |   } /* foo */
     1.140 us [11558] | } /* main */
</code></pre>
---
class: code-26px
### Filters
- -D DEPTH, --depth=DEPTH
  - Set global trace limit in nesting level.

<pre><code class="plain">  $ gcc -pg foobar.c

  $ uftrace `-D 2` a.out
  # DURATION    TID     FUNCTION
              [11558] | main() {
     0.767 us [11558] |   foo();
     1.140 us [11558] | } /* main */
</code></pre>
---
class: code-26px
### Filters
- -F FUNC, --filter=FUNC
  - Set filter to trace selected functions only.

<pre><code class="plain">  $ gcc -pg foobar.c

  $ uftrace a.out
  # DURATION    TID     FUNCTION
              [11558] | main() {
              [11558] |   foo() {
     0.156 us [11558] |     bar();
     0.767 us [11558] |   } /* foo */
     1.140 us [11558] | } /* main */
</code></pre>
---
class: code-26px
### Filters
- -F FUNC, --filter=FUNC
  - Set filter to trace selected functions only.

<pre><code class="plain">  $ gcc -pg foobar.c

  $ uftrace `-F foo` a.out
  # DURATION    TID     FUNCTION
//              [11558] | main() {
              [11558] |   `foo`() {
     0.156 us [11558] |     bar();
     0.767 us [11558] |   } /* foo */
//     1.140 us [11558] | } /* main */
</code></pre>
---
class: code-26px
### Filters
- -F FUNC, --filter=FUNC
  - Set filter to trace selected functions only.

<pre><code class="plain">  $ gcc -pg foobar.c

  $ uftrace `-F foo` a.out
  # DURATION    TID     FUNCTION
              [11558] | `foo`() {
     0.156 us [11558] |   bar();
     0.767 us [11558] | } /* foo */
</code></pre>
---
class: code-26px
### Filters
- -N FUNC, --notrace=FUNC
  - Set filter not to trace selected functions (and children)

<pre><code class="plain">  $ gcc -pg foobar.c

  $ uftrace a.out
  # DURATION    TID     FUNCTION
              [11558] | main() {
              [11558] |   foo() {
     0.156 us [11558] |     bar();
     0.767 us [11558] |   } /* foo */
     1.140 us [11558] | } /* main */
</code></pre>
---
class: code-26px
### Filters
- -N FUNC, --notrace=FUNC
  - Set filter not to trace selected functions (and children)

<pre><code class="plain">  $ gcc -pg foobar.c

  $ uftrace `-N foo` a.out
  # DURATION    TID     FUNCTION
              [11558] | main() {
//              [11558] |   `foo`() {
//     0.156 us [11558] |     bar();
//     0.767 us [11558] |   } /* foo */
     1.140 us [11558] | } /* main */
</code></pre>
---
class: code-26px
### Filters
- -N FUNC, --notrace=FUNC
  - Set filter not to trace selected functions (and children)

<pre><code class="plain">  $ gcc -pg foobar.c

  $ uftrace `-N foo` a.out
  # DURATION    TID     FUNCTION
     1.140 us [11558] | main();
</code></pre>
---
class: code-26px
### Filters
- -t TIME, --time-filter=TIME
  - Do not show small functions under the time threshold.

<pre><code class="plain">  $ gcc -pg foobar.c

  $ uftrace a.out
  # DURATION    TID     FUNCTION
              [11558] | main() {
              [11558] |   foo() {
     0.156 us [11558] |     bar();
     0.767 us [11558] |   } /* foo */
     1.140 us [11558] | } /* main */
</code></pre>
---
class: code-26px
### Filters
- -t TIME, --time-filter=TIME
  - Do not show small functions under the time threshold.

<pre><code class="plain">  $ gcc -pg foobar.c

  $ uftrace `-t 200ns` a.out
  # DURATION    TID     FUNCTION
              [11558] | main() {
              [11558] |   foo() {
//     `0.156 us` [11558] |     bar();
     0.767 us [11558] |   } /* foo */
     1.140 us [11558] | } /* main */
</code></pre>
---
class: code-26px
### Filters
- -t TIME, --time-filter=TIME
  - Do not show small functions under the time threshold.

<pre><code class="plain">  $ gcc -pg foobar.c

  $ uftrace `-t 200ns` a.out
  # DURATION    TID     FUNCTION
              [11558] | main() {
     0.767 us [11558] |   foo();
     1.140 us [11558] | } /* main */
</code></pre>

---
name: args
template: title-layout
## Display Function Arguments
.footnote[[wiki/Tutorial:-Arguments](https://github.com/namhyung/uftrace/wiki/Tutorial:-Arguments)]

---
### 
```
    $ gcc -pg fibonacci.c
```
---
### 
```
    $ gcc -pg fibonacci.c
    $ uftrace a.out 5
    fib(5) = 5
```
---
### 
```
    $ gcc -pg fibonacci.c
    $ uftrace a.out 5
    fib(5) = 5
    # DURATION    TID     FUNCTION
                [31321] | main() {
       1.478 us [31321] |   atoi();
                [31321] |   fib() {
                [31321] |     fib() {
                [31321] |       fib() {
       0.155 us [31321] |         fib();
       0.123 us [31321] |         fib();
       0.883 us [31321] |       } /* fib */
       0.125 us [31321] |       fib();
       1.483 us [31321] |     } /* fib */
                [31321] |     fib() {
       0.125 us [31321] |       fib();
       0.125 us [31321] |       fib();
       0.774 us [31321] |     } /* fib */
       2.716 us [31321] |   } /* fib */
       4.382 us [31321] |   printf();
       9.456 us [31321] | } /* main */
```
---
### Record function arguments with -A / --argument
```
    $ gcc -pg fibonacci.c
    $ uftrace `-A fib@arg1` a.out 5
    fib(5) = 5
    # DURATION    TID     FUNCTION
                [31321] | main() {
       1.478 us [31321] |   atoi();
                [31321] |   fib(`5`) {
                [31321] |     fib(`4`) {
                [31321] |       fib(`3`) {
       0.155 us [31321] |         fib(`2`);
       0.123 us [31321] |         fib(`1`);
       0.883 us [31321] |       } /* fib */
       0.125 us [31321] |       fib(`2`);
       1.483 us [31321] |     } /* fib */
                [31321] |     fib(`3`) {
       0.125 us [31321] |       fib(`2`);
       0.125 us [31321] |       fib(`1`);
       0.774 us [31321] |     } /* fib */
       2.716 us [31321] |   } /* fib */
       4.382 us [31321] |   printf();
       9.456 us [31321] | } /* main */
```
---
### Record function return values with -R / --retval
```
    $ gcc -pg fibonacci.c
    $ uftrace -A fib@arg1 `-R fib@retval` a.out 5
    fib(5) = 5
    # DURATION    TID     FUNCTION
                [31321] | main() {
       1.478 us [31321] |   atoi();
                [31321] |   fib(5) {
                [31321] |     fib(4) {
                [31321] |       fib(3) {
       0.155 us [31321] |         fib(2) `= 1`;
       0.123 us [31321] |         fib(1) `= 1`;
       0.883 us [31321] |       } = `2`; /* fib */
       0.125 us [31321] |       fib(2) `= 1`;
       1.483 us [31321] |     } `= 3`; /* fib */
                [31321] |     fib(3) {
       0.125 us [31321] |       fib(2) `= 1`;
       0.125 us [31321] |       fib(1) `= 1`;
       0.774 us [31321] |     } `= 2`; /* fib */
       2.716 us [31321] |   } `= 5`; /* fib */
       4.382 us [31321] |   printf();
       9.456 us [31321] | } /* main */
```
---
class: code-26px
### Record function return values with type setting
```
    $ clang -pg hello.c
    $ uftrace -A printf@`arg1` a.out 
```
---
class: code-26px
### Record function return values with type setting
```
    $ clang -pg hello.c
    $ uftrace -A printf@`arg1` a.out 
    Hello World!
    # DURATION     TID     FUNCTION
                [117536] | main() {
       6.100 us [117536] |   printf(`0x40074c`);
       7.390 us [117536] | } /* main */
```
---
class: code-26px
### Record function return values with type setting
```
    $ clang -pg hello.c
    $ uftrace -A printf@arg1`/s` a.out 
```
---
class: code-26px
### Record function return values with type setting
```
    $ clang -pg hello.c
    $ uftrace -A printf@arg1`/s` a.out 
    Hello World!
    # DURATION     TID     FUNCTION
                [117594] | main() {
     319.904 us [117594] |   printf(`"Hello World!\n"`);
     321.521 us [117594] | } /* main */
```
---
class: code-18px
### Display Function Arguments
- uftrace can record function arguments and return values
  - using the .red[-A]/.red[--argument] and .red[-R]/.red[--retval] options.

```
    <argument>    :=  <symbol> "@" <specs>
    <specs>       :=  <spec> | <spec> "," <spec>
    <spec>        :=  ( <int_spec> | <float_spec> | <ret_spec> )
    <int_spec>    :=  "arg" N [ "/" <format> [ <size> ] ] [ "%" ( <reg> | <stack> ) ]
    <float_spec>  :=  "fparg" N [ "/" ( <size> | "80" ) ] [ "%" ( <reg> | <stack> ) ]
    <ret_spec>    :=  "retval" [ "/" <format> [ <size> ] ]
    <format>      :=  "d" | "i" | "u" | "x" | "s" | "c" | "f" | "S" | "p"
    <size>        :=  "8" | "16" | "32" | "64"
    <reg>         :=  <arch-specific register name>  # "rdi", "xmm0", "r0", ...
    <stack>       :=  "stack" [ "+" ] <offset>
```

---
name: autoargs
template: title-layout
## Arguments Detection with Debug Info
#### -a / --auto-args option
.footnote[[wiki/Tutorial:-Arguments](https://github.com/namhyung/uftrace/wiki/Tutorial:-Arguments)]
<pre><code class="bash">$ ./configure 
libdw: [ .green[on]  ]</code></pre>

---
### Detect function types using debug info with -a / --auto-args
```
    $ gcc -pg fibonacci.c
```
---
### Detect function types using debug info with -a / --auto-args
.footnote[gcc .red[-g] produces debug info ([DWARF](http://dwarfstd.org))]
```
    $ gcc -pg `-g` fibonacci.c
```
---
### Detect function types using debug info with -a / --auto-args
.footnote[.red[-a]/.red[--auto-args] uses debug info to detect type info of user functions]
```
    $ gcc -pg `-g` fibonacci.c
    $ uftrace `-a` a.out 5
```
---
### Detect function types using debug info with -a / --auto-args
<pre><code>    $ gcc -pg `-g` fibonacci.c
    $ uftrace `-a` a.out 5
    <x-orange>fib(5) = 5</x-orange>
    # DURATION    TID     FUNCTION
                [31321] | main(`2`, `0x7ffd62a92a18`) {
       1.478 us [31321] |   atoi();
                [31321] |   fib(`5`) {
                [31321] |     fib(`4`) {
                [31321] |       fib(`3`) {
       0.155 us [31321] |         fib(`2`) `= 1`;
       0.123 us [31321] |         fib(`1`) `= 1`;
       0.883 us [31321] |       } = `2`; /* fib */
       0.125 us [31321] |       fib(`2`) `= 1`;
       1.483 us [31321] |     } `= 3`; /* fib */
                [31321] |     fib(`3`) {
       0.125 us [31321] |       fib(`2`) `= 1`;
       0.125 us [31321] |       fib(`1`) `= 1`;
       0.774 us [31321] |     } `= 2`; /* fib */
       2.716 us [31321] |   } `= 5`; /* fib */
       4.382 us [31321] |   printf(<x-orange>"fib(%d) = %d\n"</x-orange>) `= 11`;
       9.456 us [31321] | } `= 0`; /* main */
</code></pre>
---
class: code-24px
### Detect function types using debug info with -a / --auto-args
.footnote[-a/--auto-args is able to detect .red[enum] and .red[function pointer] types]
<pre><code>
    $ uftrace -pg <x-red>-g</x-red> [tests/s-signal.c](https://raw.githubusercontent.com/namhyung/uftrace/master/tests/s-signal.c)
</code><pre>
```
    $ uftrace `-a` a.out
    # DURATION     TID     FUNCTION
                [117990] | main(1, 0x7ffd6b5381f8) {
       0.437 us [117990] |   foo();
       2.250 us [117990] |   signal(`SIGUSR1`, `&sighandler`) = 0;
                [117990] |   raise(`SIGUSR1`) {
                [117990] |     sighandler(10) {
       0.240 us [117990] |       bar(10);
       1.343 us [117990] |     } /* sighandler */
      14.254 us [117990] |   } /* raise */
       0.197 us [117990] |   foo();
      22.654 us [117990] | } = 0; /* main */
```

---
name: report
template: title-layout
# uftrace report
### Print statistics and summary for trace data
.footnote[[doc/uftrace-report.md](https://github.com/namhyung/uftrace/blob/master/doc/uftrace-report.md)]

---
### uftrace report
- Print statistics and summary for trace data

```
  $ gcc -pg foobar.c
```
---
### uftrace report
- Print statistics and summary for trace data

```
  $ gcc -pg foobar.c
  $ uftrace record a.out
```
---
### uftrace report
- Print statistics and summary for trace data

```
  $ gcc -pg foobar.c
  $ uftrace record a.out
  $ uftrace report
```
---
### uftrace report
- Print statistics and summary for trace data

```
  $ gcc -pg foobar.c
  $ uftrace record a.out
  $ uftrace report
  Total time  Self time      Calls Function
  ========== ========== ========== =================
    0.890 us   0.326 us          1 main
    0.564 us   0.430 us          1 foo
    0.134 us   0.134 us          1 bar
```
---
### uftrace report
- Print statistics and summary for trace data
  - Sort functions by .red[total time] (default)

```
  $ gcc -pg foobar.c
  $ uftrace record a.out
  $ uftrace report `-s total`
  `Total time`  Self time      Calls Function
  ========== ========== ========== =================
    0.890 us   0.326 us          1 main
    0.564 us   0.430 us          1 foo
    0.134 us   0.134 us          1 bar
```
---
### uftrace report
- Print statistics and summary for trace data
  - Sort functions by .red[self time]

```
  $ gcc -pg foobar.c
  $ uftrace record a.out
  $ uftrace report `-s self`
  Total time  `Self time`      Calls Function
  ========== ========== ========== =================
    0.564 us   0.430 us          1 foo
    0.890 us   0.326 us          1 main
    0.134 us   0.134 us          1 bar
```
---
### uftrace report
- Print statistics and summary for trace data
  - Sort functions by .red[number of calls]

```
  $ gcc -pg foobar.c
  $ uftrace record a.out
  $ uftrace report `-s call`
  Total time  Self time      `Calls` Function
  ========== ========== ========== =================
    0.890 us   0.326 us          1 main
    0.564 us   0.430 us          1 foo
    0.134 us   0.134 us          1 bar
```

---
name: dump
template: title-layout
# uftrace dump
### with visualization
.footnote[[doc/uftrace-dump.md](https://github.com/namhyung/uftrace/blob/master/doc/uftrace-dump.md)]

---
### [Chrome Trace Viewer](https://www.chromium.org/developers/how-tos/trace-event-profiling-tool)
- Below is a trace of clang (LLVM) compiling a small C++ template metaprogram.
  - uftrace dump --chrome
---
### [Chrome Trace Viewer](https://www.chromium.org/developers/how-tos/trace-event-profiling-tool)
.footnote[<a href="https://honggyukim.github.io/uftrace/cppcon2016/clang.tmp.fib.html" target="_blank">open in chrome trace viewer</a>]
- Below is a trace of clang (LLVM) compiling a small C++ template metaprogram.
  - uftrace dump --chrome

<a href="https://honggyukim.github.io/uftrace/cppcon2016/clang.tmp.fib.html" target="_blank">
<img src="https://raw.githubusercontent.com/namhyung/uftrace/master/doc/uftrace-chrome.png" class="center-image" width="90%">
</a>
---
### [Chrome Trace Viewer](https://www.chromium.org/developers/how-tos/trace-event-profiling-tool)
.footnote[[Catapult Project](https://github.com/catapult-project/catapult)]
- uftrace dump --chrome generates trace in [JSON format](https://docs.google.com/document/d/1CvAClvFfyA5R-PhYUmn5OOQtYMH4h6I0nSsKchNAySU/preview).
  - Catapult's [trace2html](https://github.com/catapult-project/catapult/blob/master/tracing/bin/trace2html) script can convert it to HTML.

```
        $ uftrace record a.out
```
---
### [Chrome Trace Viewer](https://www.chromium.org/developers/how-tos/trace-event-profiling-tool)
.footnote[[Catapult Project](https://github.com/catapult-project/catapult)]
- uftrace dump --chrome generates trace in [JSON format](https://docs.google.com/document/d/1CvAClvFfyA5R-PhYUmn5OOQtYMH4h6I0nSsKchNAySU/preview).
  - Catapult's [trace2html](https://github.com/catapult-project/catapult/blob/master/tracing/bin/trace2html) script can convert it to HTML.

```
        $ uftrace record a.out

        $ uftrace dump `--chrome` > uftrace-dump-chrome.json
```
---
### [Chrome Trace Viewer](https://www.chromium.org/developers/how-tos/trace-event-profiling-tool)
.footnote[[Catapult Project](https://github.com/catapult-project/catapult)]
- uftrace dump --chrome generates trace in [JSON format](https://docs.google.com/document/d/1CvAClvFfyA5R-PhYUmn5OOQtYMH4h6I0nSsKchNAySU/preview).
  - Catapult's [trace2html](https://github.com/catapult-project/catapult/blob/master/tracing/bin/trace2html) script can convert it to HTML.

```
        $ uftrace record a.out

        $ uftrace dump --chrome > uftrace-dump-chrome.json

        $ `trace2html` uftrace-dump-chrome.json
```
---
### [Chrome Trace Viewer](https://www.chromium.org/developers/how-tos/trace-event-profiling-tool)
.footnote[[Catapult Project](https://github.com/catapult-project/catapult)]
- uftrace dump --chrome generates trace in [JSON format](https://docs.google.com/document/d/1CvAClvFfyA5R-PhYUmn5OOQtYMH4h6I0nSsKchNAySU/preview).
  - Catapult's [trace2html](https://github.com/catapult-project/catapult/blob/master/tracing/bin/trace2html) script can convert it to HTML.

```
        $ uftrace record a.out

        $ uftrace dump --chrome > uftrace-dump-chrome.json

        $ trace2html uftrace-dump-chrome.json
        `uftrace-dump-chrome.html`
```
---
### [Chrome Trace Viewer](https://www.chromium.org/developers/how-tos/trace-event-profiling-tool)
.footnote[[Catapult Project](https://github.com/catapult-project/catapult)]
- uftrace dump --chrome generates trace in [JSON format](https://docs.google.com/document/d/1CvAClvFfyA5R-PhYUmn5OOQtYMH4h6I0nSsKchNAySU/preview).
  - Catapult's [trace2html](https://github.com/catapult-project/catapult/blob/master/tracing/bin/trace2html) script can convert it to HTML.

```
        $ uftrace record a.out

        $ uftrace dump --chrome > uftrace-dump-chrome.json

        $ trace2html uftrace-dump-chrome.json
        uftrace-dump-chrome.html

```

- Then run a web server to open in chrome browser (if needed)
```
        $ python -m SimpleHTTPServer 12345
        Serving HTTP on 0.0.0.0 port 12345 ...
```

---
### [Flame Graph](http://www.brendangregg.com/flamegraphs.html)
- Flame graph of gcc compiling a simple c program.
  - uftrace dump --flame-graph | [flamegraph.pl](https://raw.githubusercontent.com/brendangregg/FlameGraph/master/flamegraph.pl) > out.svg
---
### [Flame Graph](http://www.brendangregg.com/flamegraphs.html)
.footnote[<a href="https://honggyukim.github.io/uftrace/v8/octane-splay/trace_splay.js.svg" target="_blank">open in browser</a>]
- Flame graph of gcc compiling a simple c program.
  - uftrace dump --flame-graph | [flamegraph.pl](https://raw.githubusercontent.com/brendangregg/FlameGraph/master/flamegraph.pl) > out.svg

<a href="https://uftrace.github.io/dump/gcc.svg" target="_blank">
<img src="https://uftrace.github.io/dump/gcc.svg" class="center-image" width="90%">
</a>

---
name: graph
template: title-layout
# uftrace graph
### Show function call graph
.footnote[[doc/uftrace-graph.md](https://github.com/namhyung/uftrace/blob/master/doc/uftrace-graph.md)]

---
### Call graph of std::shared_ptr
```cpp
    $ cat shared_ptr.cc
    #include <memory>

    int main()
    {
        std::shared_ptr<int> sp1(new int);
    }
```
---
### Call graph of std::shared_ptr
```cpp
    $ cat shared_ptr.cc
    #include <memory>

    int main()
    {
        std::shared_ptr<int> sp1(new int);
    }
```
```
    $ g++ -std=c++11 -pg -g shared_ptr.cc
```
---
### Call graph of std::shared_ptr
```cpp
    $ cat shared_ptr.cc
    #include <memory>

    int main()
    {
        std::shared_ptr<int> sp1(new int);
    }
```
```
    $ g++ -std=c++11 -pg -g shared_ptr.cc

    $ uftrace record a.out
```
---
### Call graph of std::shared_ptr
```cpp
    $ cat shared_ptr.cc
    #include <memory>

    int main()
    {
        std::shared_ptr<int> sp1(new int);
    }
```
```
    $ g++ -std=c++11 -pg -g shared_ptr.cc

    $ uftrace record a.out

    $ uftrace `graph`
```
---
class: code-15px
.footnote[aggregated call graph]
```
    $ uftrace `graph`
    # Function Call Graph for 'a.out' (session: c6e074b930018807)
    ========== FUNCTION CALL GRAPH ==========
    # TOTAL TIME   FUNCTION
       20.914 us : (1) a.out
       20.914 us : (1) main
        1.997 us :  +-(1) operator new
                 :  |
        4.170 us :  +-(1) std::shared_ptr::shared_ptr
        3.797 us :  | (1) std::__shared_ptr::__shared_ptr
        2.967 us :  |  +-(1) std::__shared_count::__shared_count
        0.630 us :  |  |  +-(1) operator new
                 :  |  |  |
        1.357 us :  |  |  +-(1) std::_Sp_counted_ptr::_Sp_counted_ptr
        0.860 us :  |  |    (1) std::_Sp_counted_base::_Sp_counted_base
        0.230 us :  |  |    (1) std::_Mutex_base::_Mutex_base
                 :  |  |
        0.153 us :  |  +-(1) std::__enable_shared_from_this_helper
                 :  |
       10.027 us :  +-(1) std::shared_ptr::~shared_ptr
        9.700 us :    (1) std::__shared_ptr::~__shared_ptr
        9.374 us :    (1) std::__shared_count::~__shared_count
        9.054 us :    (1) std::_Sp_counted_base::_M_release
        2.093 us :     +-(2) __gnu_cxx::__exchange_and_add_dispatch
        0.287 us :     |  +-(2) __gthread_active_p
                 :     |  |
        0.260 us :     |  +-(2) __gnu_cxx::__exchange_and_add_single
                 :     |
        3.803 us :     +-(1) std::_Sp_counted_ptr::_M_dispose
        2.890 us :     | (1) operator delete
                 :     |
        2.083 us :     +-(1) std::_Sp_counted_ptr::_M_destroy
        1.697 us :       (1) std::_Sp_counted_ptr::~_Sp_counted_ptr
        0.686 us :        +-(1) std::_Sp_counted_ptr::~_Sp_counted_ptr
        0.143 us :        | (1) std::_Sp_counted_base::~_Sp_counted_base
                 :        |
        0.284 us :        +-(1) operator delete
```
---
class: code-15px
.footnote[.red[number of calls]]
```
    $ uftrace graph
    # Function Call Graph for 'a.out' (session: c6e074b930018807)
    ========== FUNCTION CALL GRAPH ==========
    # TOTAL TIME   FUNCTION
       20.914 us : (`1`) a.out
       20.914 us : (`1`) main
        1.997 us :  +-(`1`) operator new
                 :  |
        4.170 us :  +-(`1`) std::shared_ptr::shared_ptr
        3.797 us :  | (`1`) std::__shared_ptr::__shared_ptr
        2.967 us :  |  +-(`1`) std::__shared_count::__shared_count
        0.630 us :  |  |  +-(`1`) operator new
                 :  |  |  |
        1.357 us :  |  |  +-(`1`) std::_Sp_counted_ptr::_Sp_counted_ptr
        0.860 us :  |  |    (`1`) std::_Sp_counted_base::_Sp_counted_base
        0.230 us :  |  |    (`1`) std::_Mutex_base::_Mutex_base
                 :  |  |
        0.153 us :  |  +-(`1`) std::__enable_shared_from_this_helper
                 :  |
       10.027 us :  +-(`1`) std::shared_ptr::~shared_ptr
        9.700 us :    (`1`) std::__shared_ptr::~__shared_ptr
        9.374 us :    (`1`) std::__shared_count::~__shared_count
        9.054 us :    (`1`) std::_Sp_counted_base::_M_release
        2.093 us :     +-(`2`) __gnu_cxx::__exchange_and_add_dispatch
        0.287 us :     |  +-(`2`) __gthread_active_p
                 :     |  |
        0.260 us :     |  +-(`2`) __gnu_cxx::__exchange_and_add_single
                 :     |
        3.803 us :     +-(`1`) std::_Sp_counted_ptr::_M_dispose
        2.890 us :     | (`1`) operator delete
                 :     |
        2.083 us :     +-(`1`) std::_Sp_counted_ptr::_M_destroy
        1.697 us :       (`1`) std::_Sp_counted_ptr::~_Sp_counted_ptr
        0.686 us :        +-(`1`) std::_Sp_counted_ptr::~_Sp_counted_ptr
        0.143 us :        | (`1`) std::_Sp_counted_base::~_Sp_counted_base
                 :        |
        0.284 us :        +-(`1`) operator delete
```
---
class: code-15px
.footnote[.red[total time of each call graph]]
```
    $ uftrace graph
    # Function Call Graph for 'a.out' (session: c6e074b930018807)
    ========== FUNCTION CALL GRAPH ==========
    # `TOTAL TIME`   FUNCTION
       20.914 us : (1) a.out
       20.914 us : (1) main
        1.997 us :  +-(1) operator new
                 :  |
        `4.170 us` :  +-(1) `std::shared_ptr::shared_ptr`
        3.797 us :  | (1) std::__shared_ptr::__shared_ptr
        2.967 us :  |  +-(1) std::__shared_count::__shared_count
        0.630 us :  |  |  +-(1) operator new
                 :  |  |  |
        1.357 us :  |  |  +-(1) std::_Sp_counted_ptr::_Sp_counted_ptr
        0.860 us :  |  |    (1) std::_Sp_counted_base::_Sp_counted_base
        0.230 us :  |  |    (1) std::_Mutex_base::_Mutex_base
                 :  |  |
        0.153 us :  |  +-(1) std::__enable_shared_from_this_helper
                 :  |
       `10.027 us` :  +-(1) `std::shared_ptr::~shared_ptr`
        9.700 us :    (1) std::__shared_ptr::~__shared_ptr
        9.374 us :    (1) std::__shared_count::~__shared_count
        9.054 us :    (1) std::_Sp_counted_base::_M_release
        2.093 us :     +-(2) __gnu_cxx::__exchange_and_add_dispatch
        0.287 us :     |  +-(2) __gthread_active_p
                 :     |  |
        0.260 us :     |  +-(2) __gnu_cxx::__exchange_and_add_single
                 :     |
        3.803 us :     +-(1) std::_Sp_counted_ptr::_M_dispose
        2.890 us :     | (1) operator delete
                 :     |
        2.083 us :     +-(1) std::_Sp_counted_ptr::_M_destroy
        1.697 us :       (1) std::_Sp_counted_ptr::~_Sp_counted_ptr
        0.686 us :        +-(1) std::_Sp_counted_ptr::~_Sp_counted_ptr
        0.143 us :        | (1) std::_Sp_counted_base::~_Sp_counted_base
                 :        |
        0.284 us :        +-(1) operator delete
```
---
class: code-15px
```
    $ uftrace graph `-f +self`
    # Function Call Graph for 'a.out' (session: c6e074b930018807)
    ========== FUNCTION CALL GRAPH ==========
    # TOTAL TIME   `SELF TIME`   FUNCTION
       20.914 us             : (1) a.out
       20.914 us    4.720 us : (1) main
        1.997 us    1.997 us :  +-(1) operator new
                             :  |
        4.170 us    0.373 us :  +-(1) std::shared_ptr::shared_ptr
        3.797 us    0.677 us :  | (1) std::__shared_ptr::__shared_ptr
        2.967 us    0.980 us :  |  +-(1) std::__shared_count::__shared_count
        0.630 us    0.630 us :  |  |  +-(1) operator new
                             :  |  |  |
        1.357 us    0.497 us :  |  |  +-(1) std::_Sp_counted_ptr::_Sp_counted_ptr
        0.860 us    0.630 us :  |  |    (1) std::_Sp_counted_base::_Sp_counted_base
        0.230 us    0.230 us :  |  |    (1) std::_Mutex_base::_Mutex_base
                             :  |  |
        0.153 us    0.153 us :  |  +-(1) std::__enable_shared_from_this_helper
                             :  |
       10.027 us    0.327 us :  +-(1) std::shared_ptr::~shared_ptr
        9.700 us    0.326 us :    (1) std::__shared_ptr::~__shared_ptr
        9.374 us    0.320 us :    (1) std::__shared_count::~__shared_count
        9.054 us    1.075 us :    (1) std::_Sp_counted_base::_M_release
        2.093 us    1.546 us :     +-(2) __gnu_cxx::__exchange_and_add_dispatch
        0.287 us    0.287 us :     |  +-(2) __gthread_active_p
                             :     |  |
        0.260 us    0.260 us :     |  +-(2) __gnu_cxx::__exchange_and_add_single
                             :     |
        3.803 us    0.913 us :     +-(1) std::_Sp_counted_ptr::_M_dispose
        2.890 us    2.890 us :     | (1) operator delete
                             :     |
        2.083 us    0.386 us :     +-(1) std::_Sp_counted_ptr::_M_destroy
        1.697 us    0.727 us :       (1) std::_Sp_counted_ptr::~_Sp_counted_ptr
        0.686 us    0.543 us :        +-(1) std::_Sp_counted_ptr::~_Sp_counted_ptr
        0.143 us    0.143 us :        | (1) std::_Sp_counted_base::~_Sp_counted_base
                             :        |
        0.284 us    0.284 us :        +-(1) operator delete
```
---
class: code-15px
```
    $ uftrace graph `-f +self,addr`
    # Function Call Graph for 'a.out' (session: c6e074b930018807)
    ========== FUNCTION CALL GRAPH ==========
    # TOTAL TIME   `SELF TIME`     `ADDRESS`     FUNCTION
       20.914 us                    400c3c : (1) a.out
       20.914 us    4.720 us        400c3c : (1) main
        1.997 us    1.997 us        400a10 :  +-(1) operator new
                                           :  |
        4.170 us    0.373 us        400cdf :  +-(1) std::shared_ptr::shared_ptr
        3.797 us    0.677 us        400d3b :  | (1) std::__shared_ptr::__shared_ptr
        2.967 us    0.980 us        400e16 :  |  +-(1) std::__shared_count::__shared_count
        0.630 us    0.630 us        400a10 :  |  |  +-(1) operator new
                                           :  |  |  |
        1.357 us    0.497 us        400f21 :  |  |  +-(1) std::_Sp_counted_ptr::_Sp_counted_ptr
        0.860 us    0.630 us        400fd1 :  |  |    (1) std::_Sp_counted_base::_Sp_counted_base
        0.230 us    0.230 us        400fbd :  |  |    (1) std::_Mutex_base::_Mutex_base
                                           :  |  |
        0.153 us    0.153 us        400e91 :  |  +-(1) std::__enable_shared_from_this_helper
                                           :  |
       10.027 us    0.327 us        400cbf :  +-(1) std::shared_ptr::~shared_ptr
        9.700 us    0.326 us        400c9b :    (1) std::__shared_ptr::~__shared_ptr
        9.374 us    0.320 us        400d0b :    (1) std::__shared_count::~__shared_count
        9.054 us    1.075 us        400d95 :    (1) std::_Sp_counted_base::_M_release
        2.093 us    1.546 us        400bf4 :     +-(2) __gnu_cxx::__exchange_and_add_dispatch
        0.287 us    0.287 us        400b7f :     |  +-(2) __gthread_active_p
                                           :     |  |
        0.260 us    0.260 us        400bc1 :     |  +-(2) __gnu_cxx::__exchange_and_add_single
                                           :     |
        3.803 us    0.913 us        40107f :     +-(1) std::_Sp_counted_ptr::_M_dispose
        2.890 us    2.890 us        400960 :     | (1) operator delete
                                           :     |
        2.083 us    0.386 us        4010a3 :     +-(1) std::_Sp_counted_ptr::_M_destroy
        1.697 us    0.727 us        401053 :       (1) std::_Sp_counted_ptr::~_Sp_counted_ptr
        0.686 us    0.543 us        401013 :        +-(1) std::_Sp_counted_ptr::~_Sp_counted_ptr
        0.143 us    0.143 us        400f5d :        | (1) std::_Sp_counted_base::~_Sp_counted_base
                                           :        |
        0.284 us    0.284 us        400960 :        +-(1) operator delete
```

---
name: tui
template: title-layout
# uftrace tui
### (Interactive) Text-based User Interface
.footnote[[doc/uftrace-tui.md](https://github.com/namhyung/uftrace/blob/master/doc/uftrace-tui.md)]
<pre><code class="bash">$ ./configure       
libncursesw: [ .green[on]  ]</code></pre>

---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
  <x-tui-white-line>    7.019 us : (1) a.out</x-tui-white-line>
      7.019 us : (1) main
      2.181 us :  ├─(2) std::shared_ptr::shared_ptr
      1.949 us :  │ (2) std::\__shared_ptr::\__shared_ptr
      1.602 us :  │  ├─(2) std::\__shared_count::\__shared_count
      0.780 us :  │  │  ├─(1) std::_Sp_counted_ptr::_Sp_counted_ptr
      0.645 us :  │  │  │ (1) std::_Sp_counted_base::_Sp_counted_base
      0.070 us :  │  │  │ (1) std::_Mutex_base::_Mutex_base
               :  │  │  │
      0.549 us :  │  │  └─(1) std::_Sp_counted_base::_M_add_ref_copy
      0.379 us :  │  │    (1) \__gnu_cxx::\__atomic_add_dispatch
      0.047 us :  │  │     ├─(1) \__gthread_active_p
               :  │  │     │
      0.042 us :  │  │     └─(1) \__gnu_cxx::\__atomic_add
               :  │  │
      0.044 us :  │  └─(1) std::\__enable_shared_from_this_helper
               :  │
      4.030 us :  └─(2) std::shared_ptr::~shared_ptr
      3.838 us :    (2) std::\__shared_ptr::~\__shared_ptr
      3.653 us :    (2) std::\__shared_count::~\__shared_count
      3.460 us :    (2) std::_Sp_counted_base::_M_release
      0.879 us :     ├─(3) \__gnu_cxx::\__exchange_and_add_dispatch
      0.116 us :     │  ├─(3) \__gthread_active_p
               :     │  │
      0.126 us :     │  └─(3) \__gnu_cxx::\__exchange_and_add
               :     │
      1.522 us :     ├─(1) std::_Sp_counted_ptr::_M_dispose
      1.021 us :     │ (1) operator delete
               :     │
      0.597 us :     └─(1) std::_Sp_counted_ptr::_M_destroy
      0.494 us :       (1) std::_Sp_counted_ptr::~_Sp_counted_ptr
      0.217 us :        ├─(1) std::_Sp_counted_ptr::~_Sp_counted_ptr
      0.041 us :        │ (1) std::_Sp_counted_base::~_Sp_counted_base
               :        │
      0.068 us :        └─(1) operator delete
  
  <x-tui-blue-line>uftrace graph: session c3d2c13b51a25a6b (/home/honggyu/uftrace/a.out)</x-tui-blue-line>
</pre>
</code>
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
  <x-tui-white-line>    7.019 us : (1) main</x-tui-white-line>
      2.181 us :  ├─(2) std::shared_ptr::shared_ptr
      1.949 us :  │ (2) std::\__shared_ptr::\__shared_ptr
      1.602 us :  │  ├─(2) std::\__shared_count::\__shared_count
      0.780 us :  │  │  ├─(1) std::_Sp_counted_ptr::_Sp_counted_ptr
      0.645 us :  │  │  │ (1) std::_Sp_counted_base::_Sp_counted_base
      0.070 us :  │  │  │ (1) std::_Mutex_base::_Mutex_base
               :  │  │  │
      0.549 us :  │  │  └─(1) std::_Sp_counted_base::_M_add_ref_copy
      0.379 us :  │  │    (1) \__gnu_cxx::\__atomic_add_dispatch
      0.047 us :  │  │     ├─(1) \__gthread_active_p
               :  │  │     │
      0.042 us :  │  │     └─(1) \__gnu_cxx::\__atomic_add
               :  │  │
      0.044 us :  │  └─(1) std::\__enable_shared_from_this_helper
               :  │
      4.030 us :  └─(2) std::shared_ptr::~shared_ptr
      3.838 us :    (2) std::\__shared_ptr::~\__shared_ptr
      3.653 us :    (2) std::\__shared_count::~\__shared_count
      3.460 us :    (2) std::_Sp_counted_base::_M_release
      0.879 us :     ├─(3) \__gnu_cxx::\__exchange_and_add_dispatch
      0.116 us :     │  ├─(3) \__gthread_active_p
               :     │  │
      0.126 us :     │  └─(3) \__gnu_cxx::\__exchange_and_add
               :     │
      1.522 us :     ├─(1) std::_Sp_counted_ptr::_M_dispose
      1.021 us :     │ (1) operator delete
               :     │
      0.597 us :     └─(1) std::_Sp_counted_ptr::_M_destroy
      0.494 us :       (1) std::_Sp_counted_ptr::~_Sp_counted_ptr
      0.217 us :        ├─(1) std::_Sp_counted_ptr::~_Sp_counted_ptr
      0.041 us :        │ (1) std::_Sp_counted_base::~_Sp_counted_base
               :        │
      0.068 us :        └─(1) operator delete
  
  <x-tui-blue-line>uftrace graph: source location is not available [at 0x562731a8bee9]</x-tui-blue-line>
</pre>
</code>
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
  <x-tui-white-line>    7.019 us : (1) main</x-tui-white-line>
      2.181 us :  ├─(2) std::shared_ptr::shared_ptr
      1.949 us :  │ (2) std::\__shared_ptr::\__shared_ptr
      1.602 us :  │  ├─(2) std::\__shared_count::\__shared_count
      0.780 us : ┌──────────────────────────────────────────────────────────────┐
      0.645 us : │Help: (press any key to exit)                                 │
      0.070 us : │                                                              │
               : │ ARROW         Navigation                                     │
      0.549 us : │ PgUp/Dn                                                      │
      0.379 us : │ Home/End                                                     │
      0.047 us : │ <x-red>Enter         Select/Fold</x-red>                                    │
               : │ G             Show (full) call graph                         │
      0.042 us : │ g             Show call graph for this function              │
               : │ R             Show uftrace report                            │
      0.044 us : │ I             Show uftrace info                              │
               : │ S             Change session                                 │
      4.030 us : │ O             Open editor                                    │
      3.838 us : │ c/e           Collapse/Expand graph                          │
      3.653 us : │ n/p           Next/Prev sibling                              │
      3.460 us : │ u             Move up to parent                              │
      0.879 us : │ l             Move to the longest executed child             │
      0.116 us : │ j/k           Move down/up                                   │
               : │ /             Search                                         │
      0.126 us : │ </>/N/P       Search next/prev                               │
               : │ v             Show debug message                             │
      1.522 us : │ h/?           Show this help                                 │
      1.021 us : │ q             Quit                                           │
               : │                                                              │
      0.597 us : └──────────────────────────────────────────────────────────────┘
      0.494 us :       (1) std::_Sp_counted_ptr::~_Sp_counted_ptr
      0.217 us :        ├─(1) std::_Sp_counted_ptr::~_Sp_counted_ptr
      0.041 us :        │ (1) std::_Sp_counted_base::~_Sp_counted_base
               :        │
      0.068 us :        └─(1) operator delete

  <x-tui-blue-line>uftrace graph: source location is not available [at 0x562731a8bee9]</x-tui-blue-line>
</pre>
</code>
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
  <x-tui-white-line>    7.019 us :<x-red>▶</x-red>(1) main</x-tui-white-line>
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  <x-tui-blue-line>uftrace graph: source location is not available [at 0x562731a8bee9]</x-tui-blue-line>
</pre>
</code>
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
  <x-tui-white-line>    7.019 us :▶(1) main</x-tui-white-line>
  &nbsp;
  &nbsp;
  &nbsp;
                 ┌──────────────────────────────────────────────────────────────┐
                 │Help: (press any key to exit)                                 │
                 │                                                              │
                 │ ARROW         Navigation                                     │
                 │ PgUp/Dn                                                      │
                 │ Home/End                                                     │
                 │ <x-red>Enter         Select/Fold</x-red>                                    │
                 │ G             Show (full) call graph                         │
                 │ g             Show call graph for this function              │
                 │ R             Show uftrace report                            │
                 │ I             Show uftrace info                              │
                 │ S             Change session                                 │
                 │ O             Open editor                                    │
                 │ c/e           Collapse/Expand graph                          │
                 │ n/p           Next/Prev sibling                              │
                 │ u             Move up to parent                              │
                 │ l             Move to the longest executed child             │
                 │ j/k           Move down/up                                   │
                 │ /             Search                                         │
                 │ </>/N/P       Search next/prev                               │
                 │ v             Show debug message                             │
                 │ h/?           Show this help                                 │
                 │ q             Quit                                           │
                 │                                                              │
                 └──────────────────────────────────────────────────────────────┘
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  <x-tui-blue-line>uftrace graph: source location is not available [at 0x562731a8bee9]</x-tui-blue-line>
</pre>
</code>
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
  <x-tui-white-line>    7.019 us : (1) main</x-tui-white-line>
      2.181 us :  ├─(2) std::shared_ptr::shared_ptr
      1.949 us :  │ (2) std::\__shared_ptr::\__shared_ptr
      1.602 us :  │  ├─(2) std::\__shared_count::\__shared_count
      0.780 us :  │  │  ├─(1) std::_Sp_counted_ptr::_Sp_counted_ptr
      0.645 us :  │  │  │ (1) std::_Sp_counted_base::_Sp_counted_base
      0.070 us :  │  │  │ (1) std::_Mutex_base::_Mutex_base
               :  │  │  │
      0.549 us :  │  │  └─(1) std::_Sp_counted_base::_M_add_ref_copy
      0.379 us :  │  │    (1) \__gnu_cxx::\__atomic_add_dispatch
      0.047 us :  │  │     ├─(1) \__gthread_active_p
               :  │  │     │
      0.042 us :  │  │     └─(1) \__gnu_cxx::\__atomic_add
               :  │  │
      0.044 us :  │  └─(1) std::\__enable_shared_from_this_helper
               :  │
      4.030 us :  └─(2) std::shared_ptr::~shared_ptr
      3.838 us :    (2) std::\__shared_ptr::~\__shared_ptr
      3.653 us :    (2) std::\__shared_count::~\__shared_count
      3.460 us :    (2) std::_Sp_counted_base::_M_release
      0.879 us :     ├─(3) \__gnu_cxx::\__exchange_and_add_dispatch
      0.116 us :     │  ├─(3) \__gthread_active_p
               :     │  │
      0.126 us :     │  └─(3) \__gnu_cxx::\__exchange_and_add
               :     │
      1.522 us :     ├─(1) std::_Sp_counted_ptr::_M_dispose
      1.021 us :     │ (1) operator delete
               :     │
      0.597 us :     └─(1) std::_Sp_counted_ptr::_M_destroy
      0.494 us :       (1) std::_Sp_counted_ptr::~_Sp_counted_ptr
      0.217 us :        ├─(1) std::_Sp_counted_ptr::~_Sp_counted_ptr
      0.041 us :        │ (1) std::_Sp_counted_base::~_Sp_counted_base
               :        │
      0.068 us :        └─(1) operator delete
  
  <x-tui-blue-line>uftrace graph: source location is not available [at 0x562731a8bee9]</x-tui-blue-line>
</pre>
</code>
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
  <x-tui-white-line>    7.019 us : (1) main</x-tui-white-line>
      2.181 us :  ├─(2) std::shared_ptr::shared_ptr
      1.949 us :  │ (2) std::\__shared_ptr::\__shared_ptr
      1.602 us :  │  ├─(2) std::\__shared_count::\__shared_count
      0.780 us : ┌──────────────────────────────────────────────────────────────┐
      0.645 us : │Help: (press any key to exit)                                 │
      0.070 us : │                                                              │
               : │ ARROW         Navigation                                     │
      0.549 us : │ PgUp/Dn                                                      │
      0.379 us : │ Home/End                                                     │
      0.047 us : │ Enter         Select/Fold                                    │
               : │ G             Show (full) call graph                         │
      0.042 us : │ g             Show call graph for this function              │
               : │ R             Show uftrace report                            │
      0.044 us : │ I             Show uftrace info                              │
               : │ S             Change session                                 │
      4.030 us : │ O             Open editor                                    │
      3.838 us : │ <x-red>c</x-red>/e           <x-red>Collapse</x-red>/Expand graph                          │
      3.653 us : │ n/p           Next/Prev sibling                              │
      3.460 us : │ u             Move up to parent                              │
      0.879 us : │ l             Move to the longest executed child             │
      0.116 us : │ j/k           Move down/up                                   │
               : │ /             Search                                         │
      0.126 us : │ </>/N/P       Search next/prev                               │
               : │ v             Show debug message                             │
      1.522 us : │ h/?           Show this help                                 │
      1.021 us : │ q             Quit                                           │
               : │                                                              │
      0.597 us : └──────────────────────────────────────────────────────────────┘
      0.494 us :       (1) std::_Sp_counted_ptr::~_Sp_counted_ptr
      0.217 us :        ├─(1) std::_Sp_counted_ptr::~_Sp_counted_ptr
      0.041 us :        │ (1) std::_Sp_counted_base::~_Sp_counted_base
               :        │
      0.068 us :        └─(1) operator delete

  <x-tui-blue-line>uftrace graph: source location is not available [at 0x562731a8bee9]</x-tui-blue-line>
</pre>
</code>
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
  <x-tui-white-line>    7.019 us : (1) main</x-tui-white-line>
      2.181 us :  ├<x-red>▶</x-red>(2) std::shared_ptr::shared_ptr
               :  │
      4.030 us :  └<x-red>▶</x-red>(2) std::shared_ptr::~shared_ptr
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  <x-tui-blue-line>uftrace graph: source location is not available [at 0x562731a8bee9]</x-tui-blue-line>
</pre>
</code>
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
  <x-tui-white-line>    7.019 us : (1) main</x-tui-white-line>
      2.181 us :  ├▶(2) std::shared_ptr::shared_ptr
               :  │
      4.030 us :  └▶(2) std::shared_ptr::~shared_ptr
                 ┌──────────────────────────────────────────────────────────────┐
                 │Help: (press any key to exit)                                 │
                 │                                                              │
                 │ ARROW         Navigation                                     │
                 │ PgUp/Dn                                                      │
                 │ Home/End                                                     │
                 │ Enter         Select/Fold                                    │
                 │ G             Show (full) call graph                         │
                 │ g             Show call graph for this function              │
                 │ R             Show uftrace report                            │
                 │ I             Show uftrace info                              │
                 │ S             Change session                                 │
                 │ O             Open editor                                    │
                 │ c/<x-red>e</x-red>           Collapse/<x-red>Expand</x-red> graph                          │
                 │ n/p           Next/Prev sibling                              │
                 │ u             Move up to parent                              │
                 │ l             Move to the longest executed child             │
                 │ j/k           Move down/up                                   │
                 │ /             Search                                         │
                 │ </>/N/P       Search next/prev                               │
                 │ v             Show debug message                             │
                 │ h/?           Show this help                                 │
                 │ q             Quit                                           │
                 │                                                              │
                 └──────────────────────────────────────────────────────────────┘
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  <x-tui-blue-line>uftrace graph: source location is not available [at 0x562731a8c01e]</x-tui-blue-line>
</pre>
</code>
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
  <x-tui-white-line>    7.019 us : (1) main</x-tui-white-line>
      2.181 us :  ├─(2) std::shared_ptr::shared_ptr
      1.949 us :  │ (2) std::\__shared_ptr::\__shared_ptr
      1.602 us :  │  ├─(2) std::\__shared_count::\__shared_count
      0.780 us :  │  │  ├─(1) std::_Sp_counted_ptr::_Sp_counted_ptr
      0.645 us :  │  │  │ (1) std::_Sp_counted_base::_Sp_counted_base
      0.070 us :  │  │  │ (1) std::_Mutex_base::_Mutex_base
               :  │  │  │
      0.549 us :  │  │  └─(1) std::_Sp_counted_base::_M_add_ref_copy
      0.379 us :  │  │    (1) \__gnu_cxx::\__atomic_add_dispatch
      0.047 us :  │  │     ├─(1) \__gthread_active_p
               :  │  │     │
      0.042 us :  │  │     └─(1) \__gnu_cxx::\__atomic_add
               :  │  │
      0.044 us :  │  └─(1) std::\__enable_shared_from_this_helper
               :  │
      4.030 us :  └─(2) std::shared_ptr::~shared_ptr
      3.838 us :    (2) std::\__shared_ptr::~\__shared_ptr
      3.653 us :    (2) std::\__shared_count::~\__shared_count
      3.460 us :    (2) std::_Sp_counted_base::_M_release
      0.879 us :     ├─(3) \__gnu_cxx::\__exchange_and_add_dispatch
      0.116 us :     │  ├─(3) \__gthread_active_p
               :     │  │
      0.126 us :     │  └─(3) \__gnu_cxx::\__exchange_and_add
               :     │
      1.522 us :     ├─(1) std::_Sp_counted_ptr::_M_dispose
      1.021 us :     │ (1) operator delete
               :     │
      0.597 us :     └─(1) std::_Sp_counted_ptr::_M_destroy
      0.494 us :       (1) std::_Sp_counted_ptr::~_Sp_counted_ptr
      0.217 us :        ├─(1) std::_Sp_counted_ptr::~_Sp_counted_ptr
      0.041 us :        │ (1) std::_Sp_counted_base::~_Sp_counted_base
               :        │
      0.068 us :        └─(1) operator delete
  
  <x-tui-blue-line>uftrace graph: session c3d2c13b51a25a6b (/home/honggyu/uftrace/a.out)</x-tui-blue-line>
</pre>
</code>
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
  <x-tui-white-line>    7.019 us : (1) main</x-tui-white-line>
      2.181 us :  ├─(2) std::shared_ptr::shared_ptr
      1.949 us :  │ (2) std::\__shared_ptr::\__shared_ptr
      1.602 us :  │  ├─(2) std::\__shared_count::\__shared_count
      0.780 us : ┌──────────────────────────────────────────────────────────────┐
      0.645 us : │Help: (press any key to exit)                                 │
      0.070 us : │                                                              │
               : │ ARROW         Navigation                                     │
      0.549 us : │ PgUp/Dn                                                      │
      0.379 us : │ Home/End                                                     │
      0.047 us : │ Enter         Select/Fold                                    │
               : │ G             Show (full) call graph                         │
      0.042 us : │ g             Show call graph for this function              │
               : │ R             Show uftrace report                            │
      0.044 us : │ I             Show uftrace info                              │
               : │ S             Change session                                 │
      4.030 us : │ O             Open editor                                    │
      3.838 us : │ c/e           Collapse/Expand graph                          │
      3.653 us : │ n/p           Next/Prev sibling                              │
      3.460 us : │ u             Move up to parent                              │
      0.879 us : │ <x-red>l             Move to the longest executed child</x-red>             │
      0.116 us : │ j/k           Move down/up                                   │
               : │ /             Search                                         │
      0.126 us : │ </>/N/P       Search next/prev                               │
               : │ v             Show debug message                             │
      1.522 us : │ h/?           Show this help                                 │
      1.021 us : │ q             Quit                                           │
               : │                                                              │
      0.597 us : └──────────────────────────────────────────────────────────────┘
      0.494 us :       (1) std::_Sp_counted_ptr::~_Sp_counted_ptr
      0.217 us :        ├─(1) std::_Sp_counted_ptr::~_Sp_counted_ptr
      0.041 us :        │ (1) std::_Sp_counted_base::~_Sp_counted_base
               :        │
      0.068 us :        └─(1) operator delete

  <x-tui-blue-line>uftrace graph: source location is not available [at 0x562731a8bee9]</x-tui-blue-line>
</pre>
</code>
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
  <x-tui-white-line>    7.019 us : (1) main</x-tui-white-line>
      2.181 us :  ├─(2) std::shared_ptr::shared_ptr
      1.949 us :  │ (2) std::\__shared_ptr::\__shared_ptr
      1.602 us :  │  ├─(2) std::\__shared_count::\__shared_count
      0.780 us :  │  │  ├─(1) std::_Sp_counted_ptr::_Sp_counted_ptr
      0.645 us :  │  │  │ (1) std::_Sp_counted_base::_Sp_counted_base
      0.070 us :  │  │  │ (1) std::_Mutex_base::_Mutex_base
               :  │  │  │
      0.549 us :  │  │  └─(1) std::_Sp_counted_base::_M_add_ref_copy
      0.379 us :  │  │    (1) \__gnu_cxx::\__atomic_add_dispatch
      0.047 us :  │  │     ├─(1) \__gthread_active_p
               :  │  │     │
      0.042 us :  │  │     └─(1) \__gnu_cxx::\__atomic_add
               :  │  │
      0.044 us :  │  └─(1) std::\__enable_shared_from_this_helper
               :  │
      4.030 us :  └─(2) std::shared_ptr::~shared_ptr
      3.838 us :    (2) std::\__shared_ptr::~\__shared_ptr
      3.653 us :    (2) std::\__shared_count::~\__shared_count
      3.460 us :    (2) std::_Sp_counted_base::_M_release
      0.879 us :     ├─(3) \__gnu_cxx::\__exchange_and_add_dispatch
      0.116 us :     │  ├─(3) \__gthread_active_p
               :     │  │
      0.126 us :     │  └─(3) \__gnu_cxx::\__exchange_and_add
               :     │
      1.522 us :     ├─(1) std::_Sp_counted_ptr::_M_dispose
      1.021 us :     │ (1) operator delete
               :     │
      0.597 us :     └─(1) std::_Sp_counted_ptr::_M_destroy
      0.494 us :       (1) std::_Sp_counted_ptr::~_Sp_counted_ptr
      0.217 us :        ├─(1) std::_Sp_counted_ptr::~_Sp_counted_ptr
      0.041 us :        │ (1) std::_Sp_counted_base::~_Sp_counted_base
               :        │
      0.068 us :        └─(1) operator delete
  
  <x-tui-blue-line>uftrace graph: source location is not available [at 0x562731a8bee9]</x-tui-blue-line>
</pre>
</code>
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
      7.019 us : (1) main
      <x-red>2.181 us</x-red> :  ├<x-red>▶</x-red>(2) std::shared_ptr::shared_ptr
               :  │
  <x-tui-white-line>    <x-red>4.030 us</x-red> :  └─(2) std::shared_ptr::~shared_ptr</x-tui-white-line>
      3.838 us :    (2) std::\__shared_ptr::~\__shared_ptr
      3.653 us :    (2) std::\__shared_count::~\__shared_count
      3.460 us :    (2) std::_Sp_counted_base::_M_release
      0.879 us :     ├─(3) \__gnu_cxx::\__exchange_and_add_dispatch
      0.116 us :     │  ├─(3) \__gthread_active_p
               :     │  │
      0.126 us :     │  └─(3) \__gnu_cxx::\__exchange_and_add
               :     │
      1.522 us :     ├─(1) std::_Sp_counted_ptr::_M_dispose
      1.021 us :     │ (1) operator delete
               :     │
      0.597 us :     └─(1) std::_Sp_counted_ptr::_M_destroy
      0.494 us :       (1) std::_Sp_counted_ptr::~_Sp_counted_ptr
      0.217 us :        ├─(1) std::_Sp_counted_ptr::~_Sp_counted_ptr
      0.041 us :        │ (1) std::_Sp_counted_base::~_Sp_counted_base
               :        │
      0.068 us :        └─(1) operator delete
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  <x-tui-blue-line>uftrace graph: source location is not available [at 0x562731a8bf8e]</x-tui-blue-line>
</pre>
</code>
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
      7.019 us : (1) main
      2.181 us :  ├▶(2) std::shared_ptr::shared_ptr
               :  │
      4.030 us :  └─(2) std::shared_ptr::~shared_ptr
  <x-tui-white-line>    3.838 us :    (2) std::\__shared_ptr::~\__shared_ptr</x-tui-white-line>
      3.653 us :    (2) std::\__shared_count::~\__shared_count
      3.460 us :    (2) std::_Sp_counted_base::_M_release
      0.879 us :     ├─(3) \__gnu_cxx::\__exchange_and_add_dispatch
      0.116 us :     │  ├─(3) \__gthread_active_p
               :     │  │
      0.126 us :     │  └─(3) \__gnu_cxx::\__exchange_and_add
               :     │
      1.522 us :     ├─(1) std::_Sp_counted_ptr::_M_dispose
      1.021 us :     │ (1) operator delete
               :     │
      0.597 us :     └─(1) std::_Sp_counted_ptr::_M_destroy
      0.494 us :       (1) std::_Sp_counted_ptr::~_Sp_counted_ptr
      0.217 us :        ├─(1) std::_Sp_counted_ptr::~_Sp_counted_ptr
      0.041 us :        │ (1) std::_Sp_counted_base::~_Sp_counted_base
               :        │
      0.068 us :        └─(1) operator delete
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  <x-tui-blue-line>uftrace graph: source location is not available [at 0x562731a8bf68]</x-tui-blue-line>
</pre>
</code>
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
      7.019 us : (1) main
      2.181 us :  ├▶(2) std::shared_ptr::shared_ptr
               :  │
      4.030 us :  └─(2) std::shared_ptr::~shared_ptr
      3.838 us :    (2) std::\__shared_ptr::~\__shared_ptr
  <x-tui-white-line>    3.653 us :    (2) std::\__shared_count::~\__shared_count</x-tui-white-line>
      3.460 us :    (2) std::_Sp_counted_base::_M_release
      0.879 us :     ├─(3) \__gnu_cxx::\__exchange_and_add_dispatch
      0.116 us :     │  ├─(3) \__gthread_active_p
               :     │  │
      0.126 us :     │  └─(3) \__gnu_cxx::\__exchange_and_add
               :     │
      1.522 us :     ├─(1) std::_Sp_counted_ptr::_M_dispose
      1.021 us :     │ (1) operator delete
               :     │
      0.597 us :     └─(1) std::_Sp_counted_ptr::_M_destroy
      0.494 us :       (1) std::_Sp_counted_ptr::~_Sp_counted_ptr
      0.217 us :        ├─(1) std::_Sp_counted_ptr::~_Sp_counted_ptr
      0.041 us :        │ (1) std::_Sp_counted_base::~_Sp_counted_base
               :        │
      0.068 us :        └─(1) operator delete
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  <x-tui-blue-line>uftrace graph: source location is not available [at 0x562731a8c04a]</x-tui-blue-line>
</pre>
</code>
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
      7.019 us : (1) main
      2.181 us :  ├▶(2) std::shared_ptr::shared_ptr
               :  │
      4.030 us :  └─(2) std::shared_ptr::~shared_ptr
      3.838 us :    (2) std::\__shared_ptr::~\__shared_ptr
      3.653 us :    (2) std::\__shared_count::~\__shared_count
  <x-tui-white-line>    3.460 us :    (2) std::_Sp_counted_base::_M_release</x-tui-white-line>
      0.879 us :     ├─(3) \__gnu_cxx::\__exchange_and_add_dispatch
      0.116 us :     │  ├─(3) \__gthread_active_p
               :     │  │
      0.126 us :     │  └─(3) \__gnu_cxx::\__exchange_and_add
               :     │
      1.522 us :     ├─(1) std::_Sp_counted_ptr::_M_dispose
      1.021 us :     │ (1) operator delete
               :     │
      0.597 us :     └─(1) std::_Sp_counted_ptr::_M_destroy
      0.494 us :       (1) std::_Sp_counted_ptr::~_Sp_counted_ptr
      0.217 us :        ├─(1) std::_Sp_counted_ptr::~_Sp_counted_ptr
      0.041 us :        │ (1) std::_Sp_counted_base::~_Sp_counted_base
               :        │
      0.068 us :        └─(1) operator delete
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  <x-tui-blue-line>uftrace graph: source location is not available [at 0x562731a8c04a]</x-tui-blue-line>
</pre>
</code>
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
      7.019 us : (1) main
      2.181 us :  ├▶(2) std::shared_ptr::shared_ptr
               :  │
      4.030 us :  └─(2) std::shared_ptr::~shared_ptr
      3.838 us :    (2) std::\__shared_ptr::~\__shared_ptr
      3.653 us :    (2) std::\__shared_count::~\__shared_count
      3.460 us :    (2) std::_Sp_counted_base::_M_release
      <x-red>0.879 us</x-red> :     ├<x-red>▶</x-red>(3) \__gnu_cxx::\__exchange_and_add_dispatch
               :     │
  <x-tui-white-line>    <x-red>1.522 us</x-red> :     ├─(1) std::_Sp_counted_ptr::_M_dispose</x-tui-white-line>
      1.021 us :     │ (1) operator delete
               :     │
      <x-red>0.597 us</x-red> :     └<x-red>▶</x-red>(1) std::_Sp_counted_ptr::_M_destroy
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  <x-tui-blue-line>uftrace graph: source location is not available [at 0x562731a8c41c]</x-tui-blue-line>
</pre>
</code>
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
      7.019 us : (1) main
      2.181 us :  ├▶(2) std::shared_ptr::shared_ptr
               :  │
      4.030 us :  └─(2) std::shared_ptr::~shared_ptr
      3.838 us :    (2) std::\__shared_ptr::~\__shared_ptr
      3.653 us :    (2) std::\__shared_count::~\__shared_count
      3.460 us :    (2) std::_Sp_counted_base::_M_release
      0.879 us :     ├▶(3) \__gnu_cxx::\__exchange_and_add_dispatch
               :     │
      1.522 us :     ├─(1) std::_Sp_counted_ptr::_M_dispose
  <x-tui-white-line>    1.021 us :     │ (1) operator delete</x-tui-white-line>
               :     │
      0.597 us :     └▶(1) std::_Sp_counted_ptr::_M_destroy
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  <x-tui-blue-line>uftrace graph: source location is not available [at 0x562731a8c41c]</x-tui-blue-line>
</pre>
</code>
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
      7.019 us : (1) main
      2.181 us :  ├▶(2) std::shared_ptr::shared_ptr
               :  │
      4.030 us :  └─(2) std::shared_ptr::~shared_ptr
      3.838 us : ┌──────────────────────────────────────────────────────────────┐
      3.653 us : │Help: (press any key to exit)                                 │
      3.460 us : │                                                              │
      0.879 us : │ ARROW         Navigation                                     │
               : │ PgUp/Dn                                                      │
      1.522 us : │ Home/End                                                     │
      1.021 us : │ Enter         Select/Fold                                    │
               : │ G             Show (full) call graph                         │
      0.597 us : │ g             Show call graph for this function              │
                 │ R             Show uftrace report                            │
                 │ I             Show uftrace info                              │
                 │ S             Change session                                 │
                 │ O             Open editor                                    │
                 │ c/e           Collapse/Expand graph                          │
                 │ n/p           Next/Prev sibling                              │
                 │ u             Move up to parent                              │
                 │ l             Move to the longest executed child             │
                 │ j/k           Move down/up                                   │
                 │ /             Search                                         │
                 │ </>/N/P       Search next/prev                               │
                 │ v             Show debug message                             │
                 │ h/?           Show this help                                 │
                 │ q             Quit                                           │
                 │                                                              │
                 └──────────────────────────────────────────────────────────────┘
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  <x-tui-blue-line>uftrace graph: source location is not available [at 0x562731a8bbb0]</x-tui-blue-line>
</pre>
</code>
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
      7.019 us : (1) main
      2.181 us :  ├▶(2) std::shared_ptr::shared_ptr
               :  │
      4.030 us :  └─(2) std::shared_ptr::~shared_ptr
      3.838 us : ┌──────────────────────────────────────────────────────────────┐
      3.653 us : │Help: (press any key to exit)                                 │
      3.460 us : │                                                              │
      0.879 us : │ ARROW         Navigation                                     │
               : │ PgUp/Dn                                                      │
      1.522 us : │ Home/End                                                     │
      1.021 us : │ Enter         Select/Fold                                    │
               : │ G             Show (full) call graph                         │
      0.597 us : │ g             Show call graph for this function              │
                 │ R             Show uftrace report                            │
                 │ I             Show uftrace info                              │
                 │ S             Change session                                 │
                 │ O             Open editor                                    │
                 │ c/e           Collapse/Expand graph                          │
                 │ n/p           Next/Prev sibling                              │
                 │ <x-red>u             Move up to parent</x-red>                              │
                 │ l             Move to the longest executed child             │
                 │ j/k           Move down/up                                   │
                 │ /             Search                                         │
                 │ </>/N/P       Search next/prev                               │
                 │ v             Show debug message                             │
                 │ h/?           Show this help                                 │
                 │ q             Quit                                           │
                 │                                                              │
                 └──────────────────────────────────────────────────────────────┘
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  <x-tui-blue-line>uftrace graph: source location is not available [at 0x562731a8bbb0]</x-tui-blue-line>
</pre>
</code>
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
      7.019 us : (1) main
      2.181 us :  ├▶(2) std::shared_ptr::shared_ptr
               :  │
      4.030 us :  └─(2) std::shared_ptr::~shared_ptr
      3.838 us :    (2) std::\__shared_ptr::~\__shared_ptr
      3.653 us :    (2) std::\__shared_count::~\__shared_count
      3.460 us :    (2) std::_Sp_counted_base::_M_release
      0.879 us :     ├▶(3) \__gnu_cxx::\__exchange_and_add_dispatch
               :     │
      1.522 us :     ├─(1) std::_Sp_counted_ptr::_M_dispose
  <x-tui-white-line>    1.021 us :     │ (1) operator delete</x-tui-white-line>
               :     │
      0.597 us :     └▶(1) std::_Sp_counted_ptr::_M_destroy
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  <x-tui-blue-line>uftrace graph: source location is not available [at 0x562731a8c41c]</x-tui-blue-line>
</pre>
</code>
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
      7.019 us : (1) main
      2.181 us :  ├▶(2) std::shared_ptr::shared_ptr
               :  │
      4.030 us :  └─(2) std::shared_ptr::~shared_ptr
      3.838 us :    (2) std::\__shared_ptr::~\__shared_ptr
      3.653 us :    (2) std::\__shared_count::~\__shared_count
      3.460 us :    (2) std::_Sp_counted_base::_M_release
      0.879 us :     ├▶(3) \__gnu_cxx::\__exchange_and_add_dispatch
               :     │
  <x-tui-white-line>    1.522 us :     ├─(1) std::_Sp_counted_ptr::_M_dispose</x-tui-white-line>
      1.021 us :     │ (1) operator delete
               :     │
      0.597 us :     └▶(1) std::_Sp_counted_ptr::_M_destroy
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  <x-tui-blue-line>uftrace graph: source location is not available [at 0x562731a8c41c]</x-tui-blue-line>
</pre>
</code>
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
      7.019 us : (1) main
      2.181 us :  ├▶(2) std::shared_ptr::shared_ptr
               :  │
      4.030 us :  └─(2) std::shared_ptr::~shared_ptr
      3.838 us :    (2) std::\__shared_ptr::~\__shared_ptr
      3.653 us :    (2) std::\__shared_count::~\__shared_count
  <x-tui-white-line>    3.460 us :    (2) std::_Sp_counted_base::_M_release</x-tui-white-line>
      0.879 us :     ├▶(3) \__gnu_cxx::\__exchange_and_add_dispatch
               :     │
      1.522 us :     ├▶(1) std::_Sp_counted_ptr::_M_dispose
               :     │
      0.597 us :     └▶(1) std::_Sp_counted_ptr::_M_destroy
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  <x-tui-blue-line>uftrace graph: source location is not available [at 0x562731a8c118]</x-tui-blue-line>
</pre>
</code>
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
      7.019 us : (1) main
      2.181 us :  ├▶(2) std::shared_ptr::shared_ptr
               :  │
      4.030 us :  └─(2) std::shared_ptr::~shared_ptr
      3.838 us :    (2) std::\__shared_ptr::~\__shared_ptr
  <x-tui-white-line>    3.653 us :    (2) std::\__shared_count::~\__shared_count</x-tui-white-line>
      3.460 us :   ▶(2) std::_Sp_counted_base::_M_release
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  <x-tui-blue-line>uftrace graph: source location is not available [at 0x562731a8c04a]</x-tui-blue-line>
</pre>
</code>
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
      7.019 us : (1) main
      2.181 us :  ├▶(2) std::shared_ptr::shared_ptr
               :  │
      4.030 us :  └─(2) std::shared_ptr::~shared_ptr
  <x-tui-white-line>    3.838 us :    (2) std::\__shared_ptr::~\__shared_ptr</x-tui-white-line>
      3.653 us :   ▶(2) std::\__shared_count::~\__shared_count
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  <x-tui-blue-line>uftrace graph: source location is not available [at 0x562731a8bf68]</x-tui-blue-line>
</pre>
</code>
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
      7.019 us : (1) main
      2.181 us :  ├▶(2) std::shared_ptr::shared_ptr
               :  │
  <x-tui-white-line>    4.030 us :  └─(2) std::shared_ptr::~shared_ptr</x-tui-white-line>
      3.838 us :   ▶(2) std::\__shared_ptr::~\__shared_ptr
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  <x-tui-blue-line>uftrace graph: source location is not available [at 0x562731a8bf8e]</x-tui-blue-line>
</pre>
</code>
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
  <x-tui-white-line>    7.019 us : (1) main</x-tui-white-line>
      2.181 us :  ├▶(2) std::shared_ptr::shared_ptr
               :  │
      4.030 us :  └▶(2) std::shared_ptr::~shared_ptr
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  <x-tui-blue-line>uftrace graph: source location is not available [at 0x562731a8bee9]</x-tui-blue-line>
</pre>
</code>
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
      7.019 us : (1) main
  <x-tui-white-line>    2.181 us :  ├▶(2) std::shared_ptr::shared_ptr</x-tui-white-line>
               :  │
      4.030 us :  └▶(2) std::shared_ptr::~shared_ptr
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  <x-tui-blue-line>uftrace graph: source location is not available [at 0x562731a8bee9]</x-tui-blue-line>
</pre>
</code>
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
      7.019 us : (1) main
  <x-tui-white-line>    2.181 us :  ├▶(2) std::shared_ptr::shared_ptr</x-tui-white-line>
               :  │
      4.030 us :  └▶(2) std::shared_ptr::~shared_ptr
                 ┌──────────────────────────────────────────────────────────────┐
                 │Help: (press any key to exit)                                 │
                 │                                                              │
                 │ ARROW         Navigation                                     │
                 │ PgUp/Dn                                                      │
                 │ Home/End                                                     │
                 │ Enter         Select/Fold                                    │
                 │ G             Show (full) call graph                         │
                 │ g             Show call graph for this function              │
                 │ R             Show uftrace report                            │
                 │ I             Show uftrace info                              │
                 │ S             Change session                                 │
                 │ O             Open editor                                    │
                 │ c/e           Collapse/Expand graph                          │
                 │ n/p           Next/Prev sibling                              │
                 │ u             Move up to parent                              │
                 │ <x-red>l             Move to the longest executed child</x-red>             │
                 │ j/k           Move down/up                                   │
                 │ /             Search                                         │
                 │ </>/N/P       Search next/prev                               │
                 │ v             Show debug message                             │
                 │ h/?           Show this help                                 │
                 │ q             Quit                                           │
                 │                                                              │
                 └──────────────────────────────────────────────────────────────┘
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  <x-tui-blue-line>uftrace graph: source location is not available [at 0x562731a8c01e]</x-tui-blue-line>
</pre>
</code>
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
      7.019 us : (1) main
      2.181 us :  ├─(2) std::shared_ptr::shared_ptr
  <x-tui-white-line>    1.949 us :  │ (2) std::\__shared_ptr::\__shared_ptr</x-tui-white-line>
      1.602 us :  │  ├─(2) std::\__shared_count::\__shared_count
      0.780 us :  │  │  ├─(1) std::_Sp_counted_ptr::_Sp_counted_ptr
      0.645 us :  │  │  │ (1) std::_Sp_counted_base::_Sp_counted_base
      0.070 us :  │  │  │ (1) std::_Mutex_base::_Mutex_base
               :  │  │  │
      0.549 us :  │  │  └▶(1) std::_Sp_counted_base::_M_add_ref_copy
               :  │  │
      0.044 us :  │  └─(1) std::\__enable_shared_from_this_helper
               :  │
      4.030 us :  └▶(2) std::shared_ptr::~shared_ptr
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  <x-tui-blue-line>uftrace graph: source location is not available [at 0x562731a8c364]</x-tui-blue-line>
</pre>
</code>
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
      7.019 us : (1) main
      2.181 us :  ├─(2) std::shared_ptr::shared_ptr
      1.949 us :  │ (2) std::\__shared_ptr::\__shared_ptr
  <x-tui-white-line>    1.602 us :  │  ├─(2) std::\__shared_count::\__shared_count</x-tui-white-line>
      0.780 us :  │  │  ├─(1) std::_Sp_counted_ptr::_Sp_counted_ptr
      0.645 us :  │  │  │ (1) std::_Sp_counted_base::_Sp_counted_base
      0.070 us :  │  │  │ (1) std::_Mutex_base::_Mutex_base
               :  │  │  │
      0.549 us :  │  │  └▶(1) std::_Sp_counted_base::_M_add_ref_copy
               :  │  │
      0.044 us :  │  └─(1) std::\__enable_shared_from_this_helper
               :  │
      4.030 us :  └▶(2) std::shared_ptr::~shared_ptr
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  <x-tui-blue-line>uftrace graph: source location is not available [at 0x562731a8c364]</x-tui-blue-line>
</pre>
</code>
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
      7.019 us : (1) main
      2.181 us :  ├─(2) std::shared_ptr::shared_ptr
      1.949 us :  │ (2) std::\__shared_ptr::\__shared_ptr
      1.602 us :  │  ├─(2) std::\__shared_count::\__shared_count
  <x-tui-white-line>    0.780 us :  │  │  ├─(1) std::_Sp_counted_ptr::_Sp_counted_ptr</x-tui-white-line>
      0.645 us :  │  │  │ (1) std::_Sp_counted_base::_Sp_counted_base
      0.070 us :  │  │  │ (1) std::_Mutex_base::_Mutex_base
               :  │  │  │
      0.549 us :  │  │  └▶(1) std::_Sp_counted_base::_M_add_ref_copy
               :  │  │
      0.044 us :  │  └─(1) std::\__enable_shared_from_this_helper
               :  │
      4.030 us :  └▶(2) std::shared_ptr::~shared_ptr
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  <x-tui-blue-line>uftrace graph: source location is not available [at 0x562731a8c364]</x-tui-blue-line>
</pre>
</code>
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
      7.019 us : (1) main
      2.181 us :  ├─(2) std::shared_ptr::shared_ptr
      1.949 us :  │ (2) std::\__shared_ptr::\__shared_ptr
      1.602 us :  │  ├─(2) std::\__shared_count::\__shared_count
      0.780 us :  │  │  ├─(1) std::_Sp_counted_ptr::_Sp_counted_ptr
  <x-tui-white-line>    0.645 us :  │  │  │ (1) std::_Sp_counted_base::_Sp_counted_base</x-tui-white-line>
      0.070 us :  │  │  │ (1) std::_Mutex_base::_Mutex_base
               :  │  │  │
      0.549 us :  │  │  └▶(1) std::_Sp_counted_base::_M_add_ref_copy
               :  │  │
      0.044 us :  │  └─(1) std::\__enable_shared_from_this_helper
               :  │
      4.030 us :  └▶(2) std::shared_ptr::~shared_ptr
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  <x-tui-blue-line>uftrace graph: source location is not available [at 0x562731a8c364]</x-tui-blue-line>
</pre>
</code>
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
      7.019 us : (1) main
      2.181 us :  ├─(2) std::shared_ptr::shared_ptr
      1.949 us :  │ (2) std::\__shared_ptr::\__shared_ptr
      1.602 us :  │  ├─(2) std::\__shared_count::\__shared_count
      0.780 us :  │  │  ├─(1) std::_Sp_counted_ptr::_Sp_counted_ptr
      0.645 us :  │  │  │ (1) std::_Sp_counted_base::_Sp_counted_base
  <x-tui-white-line>    0.070 us :  │  │  │ (1) std::_Mutex_base::_Mutex_base</x-tui-white-line>
               :  │  │  │
      0.549 us :  │  │  └▶(1) std::_Sp_counted_base::_M_add_ref_copy
               :  │  │
      0.044 us :  │  └─(1) std::\__enable_shared_from_this_helper
               :  │
      4.030 us :  └▶(2) std::shared_ptr::~shared_ptr
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  <x-tui-blue-line>uftrace graph: /usr/include/c++/6/bits/shared_ptr_base.h [line:89]</x-tui-blue-line>
</pre>
</code>
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
      7.019 us : (1) main
      2.181 us :  ├─(2) std::shared_ptr::shared_ptr
      1.949 us :  │ (2) std::\__shared_ptr::\__shared_ptr
      1.602 us :  │  ├─(2) std::\__shared_count::\__shared_count
      0.780 us : ┌──────────────────────────────────────────────────────────────┐
      0.645 us : │Help: (press any key to exit)                                 │
      0.070 us : │                                                              │
               : │ ARROW         Navigation                                     │
      0.549 us : │ PgUp/Dn                                                      │
               : │ Home/End                                                     │
      0.044 us : │ Enter         Select/Fold                                    │
               : │ G             Show (full) call graph                         │
      4.030 us : │ g             Show call graph for this function              │
                 │ R             Show uftrace report                            │
                 │ I             Show uftrace info                              │
                 │ S             Change session                                 │
                 │ <x-red>O             Open editor</x-red>                                    │
                 │ c/e           Collapse/Expand graph                          │
                 │ n/p           Next/Prev sibling                              │
                 │ u             Move up to parent                              │
                 │ l             Move to the longest executed child             │
                 │ j/k           Move down/up                                   │
                 │ /             Search                                         │
                 │ </>/N/P       Search next/prev                               │
                 │ v             Show debug message                             │
                 │ h/?           Show this help                                 │
                 │ q             Quit                                           │
                 │                                                              │
                 └──────────────────────────────────────────────────────────────┘
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  <x-tui-blue-line>uftrace graph: <x-red>/usr/include/c++/6/bits/shared_ptr_base.h</x-red> [<x-red>line:89</x-red>]</x-tui-blue-line>
</pre>
</code>
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
      7.019 us : (1) main
      2.181 us :  ├─(2) std::shared_ptr::shared_ptr
      1.949 us :  │ (2) std::\__shared_ptr::\__shared_ptr
      1.602 us :  │  ├─(2) std::\__shared_count::\__shared_count
      0.780 us :  │  │  ├─(1) std::_Sp_counted_ptr::_Sp_counted_ptr
      0.645 us :  │  │  │ (1) std::_Sp_counted_base::_Sp_counted_base
  <x-tui-white-line>    0.070 us :  │  │  │ (1) std::_Mutex_base::_Mutex_base</x-tui-white-line>
               :  │  │  │
      0.549 us :  │  │  └▶(1) std::_Sp_counted_base::_M_add_ref_copy
               :  │  │
      0.044 us :  │  └─(1) std::\__enable_shared_from_this_helper
               :  │
      4.030 us :  └▶(2) std::shared_ptr::~shared_ptr
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  <x-tui-blue-line>uftrace graph: <x-red>/usr/include/c++/6/bits/shared_ptr_base.h</x-red> [<x-red>line:89</x-red>]</x-tui-blue-line>
</pre>
</code>
---
class: tui
.footnote[Open editor]
```cpp
    73     virtual ~bad_weak_ptr() noexcept;
    74   };
    75 
    76   // Substitute for bad_weak_ptr object in the case of -fno-exceptions.
    77   inline void
    78   __throw_bad_weak_ptr()
    79   { _GLIBCXX_THROW_OR_ABORT(bad_weak_ptr()); }
    80 
    81   using __gnu_cxx::_Lock_policy;
    82   using __gnu_cxx::__default_lock_policy;
    83   using __gnu_cxx::_S_single;
    84   using __gnu_cxx::_S_mutex;
    85   using __gnu_cxx::_S_atomic;
    86 
    87   // Empty helper class except when the template argument is _S_mutex.
    88   template<_Lock_policy _Lp>
*   89     class _Mutex_base
    90     {
    91     protected:
    92       // The atomic policy uses fully-fenced builtins, single doesn't care.
    93       enum { _S_need_barriers = 0 };
    94     };
    95 
    96   template<>
    97     class _Mutex_base<_S_mutex>
    98     : public __gnu_cxx::__mutex
    99     {
   100     protected:
   101       // This policy is used when atomic builtins are not available.
   102       // The replacement atomic operations might not have the necessary
   103       // memory barriers.
   104       enum { _S_need_barriers = 1 };
   105     };
   106 
   107   template<_Lock_policy _Lp = __default_lock_policy>
   108     class _Sp_counted_base
  "/usr/include/c++/6/bits/shared_ptr_base.h" [readonly] 1599L, 45675C
```
---
class: tui
<pre>
<code class="plain">  <x-tui-blue-line>  TOTAL TIME : FUNCTION</x-tui-blue-line>
      7.019 us : (1) a.out
      7.019 us : (1) main
      2.181 us :  ├─(2) std::shared_ptr::shared_ptr
      1.949 us :  │ (2) std::\__shared_ptr::\__shared_ptr
      1.602 us :  │  ├─(2) std::\__shared_count::\__shared_count
      0.780 us :  │  │  ├─(1) std::_Sp_counted_ptr::_Sp_counted_ptr
      0.645 us :  │  │  │ (1) std::_Sp_counted_base::_Sp_counted_base
  <x-tui-white-line>    0.070 us :  │  │  │ (1) std::_Mutex_base::_Mutex_base</x-tui-white-line>
               :  │  │  │
      0.549 us :  │  │  └▶(1) std::_Sp_counted_base::_M_add_ref_copy
               :  │  │
      0.044 us :  │  └─(1) std::\__enable_shared_from_this_helper
               :  │
      4.030 us :  └▶(2) std::shared_ptr::~shared_ptr
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  &nbsp;
  <x-tui-blue-line>uftrace graph: /usr/include/c++/6/bits/shared_ptr_base.h [line:89]</x-tui-blue-line>
</pre>
</code>

---
name: python
template: title-layout
# (Python) Scripting
### uftrace record -S / uftrace script -S
.footnote[[doc/uftrace-script.md](https://github.com/namhyung/uftrace/blob/master/doc/uftrace-script.md)]
<pre><code class="bash">$ ./configure        
libpython2.7: [ .green[on]  ]</code></pre>

---
name: dynamic-tracing
template: title-layout
# Dynamic Tracing
### dynamic function tracing enabled at runtime
.footnote[[doc/uftrace-record.md#dynamic-tracing](https://github.com/namhyung/uftrace/blob/master/doc/uftrace-record.md#dynamic-tracing)]

---
### Dynamic tracing
- need (recent) compiler support
  - add a [nop-sled](https://en.wikipedia.org/wiki/NOP_slide) when compile
  - convert it to jump at runtime (load-time precisely)
---
### Dynamic tracing
- need (recent) compiler support
  - add a [nop-sled](https://en.wikipedia.org/wiki/NOP_slide) when compile
  - convert it to jump at runtime (load-time precisely)


- gcc has .red[-mnop-mcount]
```
  $ gcc -pg -mfentry -mnop-mcount -o t-abc s-abc.c
```
---
### Dynamic tracing
- need (recent) compiler support
  - add a [nop-sled](https://en.wikipedia.org/wiki/NOP_slide) when compile
  - convert it to jump at runtime (load-time precisely)


- gcc has .red[-mnop-mcount]
```
  $ gcc -pg -mfentry -mnop-mcount -o t-abc s-abc.c
```

- clang has .red[-fxray-instrument]
```
  $ clang++ -fxray-instrument -fxray-instruction-threshold=1 s-abc.c
```
---
### Dynamic tracing
```
  $ gcc -pg `-mfentry -mnop-mcount` -o t-abc s-abc.c
```
---
### Dynamic tracing
```
  $ gcc -pg -mfentry -mnop-mcount -o t-abc s-abc.c

  $ uftrace t-abc
  `uftrace: /home/honggyu/work/uftrace/cmds/record.c:1503:check_binary`
   ERROR: Can't find 'mcount' symbol in the 't-abc'.
          It seems not to be compiled with -pg or -finstrument-functions flag
          which generates traceable code.  Please check your binary file.
```
---
### Dynamic tracing
```
  $ gcc -pg -mfentry -mnop-mcount -o t-abc s-abc.c

  $ uftrace `-P b` --no-libcall t-abc
```
---
### Dynamic tracing
```
  $ gcc -pg -mfentry -mnop-mcount -o t-abc s-abc.c

  $ uftrace `-P b` --no-libcall t-abc
  # DURATION     TID     FUNCTION
     1.650 us [153473] | `b`();
```
---
### Dynamic tracing
```
  $ gcc -pg -mfentry -mnop-mcount -o t-abc s-abc.c

  $ uftrace `-P main -P b` --no-libcall t-abc
  # DURATION     TID     FUNCTION
              [153493] | `main`() {
     1.250 us [153493] |   `b`();
     3.557 us [153493] | } /* main */
```
---
### Dynamic tracing
```
  $ gcc -pg -mfentry -mnop-mcount -o t-abc s-abc.c

  $ uftrace `-P .` --no-libcall t-abc
  some functions cannot be patched dynamically
  # DURATION     TID     FUNCTION
              [153515] | `main`() {
              [153515] |   `a`() {
              [153515] |     `b`() {
     1.107 us [153515] |       `c`();
     2.871 us [153515] |     } /* b */
     3.500 us [153515] |   } /* a */
     4.644 us [153515] | } /* main */
```
---
### Dynamic tracing
.footnote[[https://llvm.org/docs/XRay.html](https://llvm.org/docs/XRay.html)]
```
  $ clang++ `-fxray-instrument -fxray-instruction-threshold=1` s-abc.c
```
---
### Dynamic tracing
```
  $ clang++ -fxray-instrument -fxray-instruction-threshold=1 s-abc.c

  $ uftrace t-abc
  `uftrace: /home/honggyu/work/uftrace/cmds/record.c:1503:check_binary`
   ERROR: Can't find 'mcount' symbol in the 't-abc'.
          It seems not to be compiled with -pg or -finstrument-functions flag
          which generates traceable code.  Please check your binary file.
```
---
### Dynamic tracing
```
  $ clang++ -fxray-instrument -fxray-instruction-threshold=1 s-abc.c

  $ uftrace `-P b` --no-libcall a.out
```
---
### Dynamic tracing
```
  $ clang++ -fxray-instrument -fxray-instruction-threshold=1 s-abc.c

  $ uftrace `-P b` --no-libcall a.out
  ==156038==Unable to determine CPU frequency for TSC accounting.
  ==156038==Unable to determine CPU frequency.
  ==156038==WARNING: Required CPU features missing for XRay instrumentation,
  using emulation instead.
  # DURATION     TID     FUNCTION
     3.140 us [156038] | `b`();
```
---
### Dynamic tracing
```
  $ clang++ -fxray-instrument -fxray-instruction-threshold=1 s-abc.c

  $ uftrace `-P main -P b` --no-libcall a.out
  ==156058==Unable to determine CPU frequency for TSC accounting.
  ==156058==Unable to determine CPU frequency.
  ==156058==WARNING: Required CPU features missing for XRay instrumentation,
  using emulation instead.
  # DURATION     TID     FUNCTION
              [156058] | `main`() {
     2.086 us [156058] |   `b`();
     4.527 us [156058] | } /* main */
```
---
### Dynamic tracing
```
  $ clang++ -fxray-instrument -fxray-instruction-threshold=1 s-abc.c

  $ uftrace `-P .` --no-libcall a.out
  ==156072==Unable to determine CPU frequency for TSC accounting.
  ==156072==Unable to determine CPU frequency.
  ==156072==WARNING: Required CPU features missing for XRay instrumentation,
  using emulation instead.
  some functions cannot be patched dynamically
  # DURATION     TID     FUNCTION
              [156072] | `main`() {
              [156072] |   `a`() {
              [156072] |     `b`() {
     2.193 us [156072] |       `c`();
     3.893 us [156072] |     } /* b */
     4.504 us [156072] |   } /* a */
     5.633 us [156072] | } /* main */
```

---
template: title-layout
# For more information

---
### man pages
- uftrace provides manual pages for each command
  - [man uftrace](https://github.com/namhyung/uftrace/blob/master/doc/uftrace.md)
  - [man uftrace record](https://github.com/namhyung/uftrace/blob/master/doc/uftrace-record.md)
  - [man uftrace replay](https://github.com/namhyung/uftrace/blob/master/doc/uftrace-replay.md)
  - [man uftrace live](https://github.com/namhyung/uftrace/blob/master/doc/uftrace-live.md)
  - [man uftrace report](https://github.com/namhyung/uftrace/blob/master/doc/uftrace-report.md)
  - [man uftrace dump](https://github.com/namhyung/uftrace/blob/master/doc/uftrace-dump.md)
  - [man uftrace graph](https://github.com/namhyung/uftrace/blob/master/doc/uftrace-graph.md)
  - [man uftrace script](https://github.com/namhyung/uftrace/blob/master/doc/uftrace-script.md)
  - [man uftrace tui](https://github.com/namhyung/uftrace/blob/master/doc/uftrace-tui.md)
  - [man uftrace info](https://github.com/namhyung/uftrace/blob/master/doc/uftrace-info.md)
  - [man uftrace recv](https://github.com/namhyung/uftrace/blob/master/doc/uftrace-recv.md)

---
name:end
template: title-layout

# Thanks!
### https://github.com/namhyung/uftrace

    </textarea>
    <script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
    <script>
      var hljs = remark.highlighter.engine;
    </script>
    <script src="https://remarkjs.com/remark.language.js"></script>
    <script>
      var slideshow = remark.create({
        // Set the slideshow display ratio
        // Default: '4:3'
        // Alternatives: '16:9', ...
        ratio: '4:3',

        // Syntax highlighting theme
        highlightStyle: 'ir-black',
        highlightLanguage: 'plain',
        highlightLines: true,
        highlightSpans: true,

        // Customize slide number label, either using a format string..
        slideNumberFormat: '%current% / %total%',

        //sourceUrl: 'extern.md',
      }) ;
    </script>
    <script>
      var comment = /(\/\*.*\*\/)/g;
      var line_comment = /^\/\/(.*)/g;
      var lines = document.getElementsByClassName('remark-code-line');
      console.log(lines);
      for (var i = 0; i < lines.length; i++) {
          lines[i].innerHTML = lines[i].innerHTML.replace(comment, '<x-grey>$1</x-grey>');
          lines[i].innerHTML = lines[i].innerHTML.replace(line_comment, '<x-grey>$1</x-grey>');
      }

      function rightPad(str, padch, padlen) {
          var pad = '';
          var tag = /<[a-z\-/]+>/g;
          padlen -= str.replace(tag, '').length;
          for (var j = 0; j < padlen; j++)
              pad += padch;
          return str + pad;
      }

      var tui_blue_lines = document.getElementsByTagName('x-tui-blue-line');
      for (var i = 0; i < tui_blue_lines.length; i++) {
          var elem = tui_blue_lines[i];
          elem.innerHTML = rightPad(elem.innerHTML, ' ', 101);
      }
      var tui_white_lines = document.getElementsByTagName('x-tui-white-line');
      for (var i = 0; i < tui_white_lines.length; i++) {
          var elem = tui_white_lines[i];
          elem.innerHTML = rightPad(elem.innerHTML, ' ', 101);
      }
    </script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-125043112-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-125043112-1');
    </script>
  </body>
</html>
